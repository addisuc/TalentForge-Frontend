<div class="layout">
  <aside class="sidebar">
    <div class="logo-section">
      <div class="logo">
        <svg width="32" height="32" viewBox="0 0 100 100" style="display: inline-block; vertical-align: middle; margin-right: 8px;">
          <defs>
            <linearGradient id="logoGradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:#0066ff;stop-opacity:1" />
              <stop offset="100%" style="stop-color:#00d4ff;stop-opacity:1" />
            </linearGradient>
          </defs>
          <text x="15" y="45" font-family="Arial, sans-serif" font-size="48" font-weight="bold" fill="url(#logoGradient)">T</text>
          <circle cx="50" cy="50" r="12" fill="none" stroke="url(#logoGradient)" stroke-width="3"/>
          <circle cx="47" cy="47" r="2" fill="#ff6b35"/>
          <circle cx="53" cy="47" r="2" fill="#ff6b35"/>
          <circle cx="50" cy="53" r="2" fill="#ff6b35"/>
          <text x="62" y="75" font-family="Arial, sans-serif" font-size="48" font-weight="bold" fill="url(#logoGradient)">F</text>
        </svg>
        <span style="font-weight: 700; font-size: 1.25rem;">TalentForge</span>
      </div>
      <div class="tenant-name">{{ getTenantName() }}</div>
    </div>
    
    <nav class="nav-menu">
      <a class="nav-item" [class.active]="activeSection === 'overview'" (click)="setActiveSection('overview')">
        <span class="icon">üìä</span>
        <span>Dashboard</span>
      </a>
      <a class="nav-item" [class.active]="activeSection === 'submissions'" (click)="setActiveSection('submissions')">
        <span class="icon">üë§</span>
        <span>Candidate Submissions</span>
        <span class="badge" *ngIf="dashboard.totalPending > 0">{{ dashboard.totalPending }}</span>
      </a>
      <a class="nav-item" [class.active]="activeSection === 'approved'" (click)="setActiveSection('approved')">
        <span class="icon">‚úÖ</span>
        <span>Approved Candidates</span>
      </a>
      <a class="nav-item" [class.active]="activeSection === 'interviews'" (click)="setActiveSection('interviews')">
        <span class="icon">üìÖ</span>
        <span>My Interviews</span>
        <span class="badge" *ngIf="scheduledInterviews.length > 0">{{ scheduledInterviews.length }}</span>
      </a>
      <a class="nav-item" [class.active]="activeSection === 'positions'" (click)="setActiveSection('positions')">
        <span class="icon">üíº</span>
        <span>Job Requests</span>
        <span class="badge" *ngIf="jobRequests.length > 0">{{ jobRequests.length }}</span>
      </a>
      <a class="nav-item" [class.active]="activeSection === 'feedback'" (click)="setActiveSection('feedback')">
        <span class="icon">üí¨</span>
        <span>Feedback & Notes</span>
      </a>
      <a class="nav-item" [class.active]="activeSection === 'reports'" (click)="setActiveSection('reports')">
        <span class="icon">üìà</span>
        <span>Hiring Progress</span>
      </a>
      <a class="nav-item" [class.active]="activeSection === 'settings'" (click)="setActiveSection('settings')">
        <span class="icon">‚öôÔ∏è</span>
        <span>Settings</span>
      </a>
    </nav>
    
    <div class="sidebar-footer">
      <a class="nav-item" (click)="logout()">
        <span class="icon">üö™</span>
        <span>Logout</span>
      </a>
    </div>
  </aside>

  <main class="main-content">
    <header class="top-bar">
      <div class="search-bar">
        <span class="icon search-icon">üîç</span>
        <input type="text" placeholder="Search candidates, positions, interviews...">
      </div>
      <div class="top-actions">
        <div class="notification-wrapper">
          <button class="icon-btn notification-bell" (click)="toggleNotifications()">
            üîî
            <span class="notification-badge" *ngIf="unreadNotifications > 0">{{ unreadNotifications }}</span>
          </button>
          
          <div class="notification-dropdown" *ngIf="showNotifications">
            <div class="notification-header">
              <h3>Notifications</h3>
              <button class="mark-all-read" (click)="markAllAsRead()" *ngIf="unreadNotifications > 0">Mark all as read</button>
            </div>
            
            <div class="notification-list">
              <div class="notification-item" 
                   *ngFor="let notification of notifications" 
                   [class.unread]="!notification.read"
                   (click)="handleNotificationClick(notification)">
                <div class="notification-icon" [class]="notification.type">
                  {{ getNotificationIcon(notification.type) }}
                </div>
                <div class="notification-content">
                  <div class="notification-title">{{ notification.title }}</div>
                  <div class="notification-message">{{ notification.message }}</div>
                  <div class="notification-time">{{ notification.time }}</div>
                </div>
                <div class="notification-dot" *ngIf="!notification.read"></div>
              </div>
              
              <div class="empty-notifications" *ngIf="notifications.length === 0">
                <span class="empty-icon">üîî</span>
                <p>No notifications yet</p>
              </div>
            </div>
            
            <div class="notification-footer">
              <a (click)="viewAllNotifications()">View All Notifications</a>
            </div>
          </div>
        </div>
        
        <div class="user-profile">
          <div class="avatar">CU</div>
          <span>Client User</span>
        </div>
      </div>
    </header>

    <div class="content">
      <!-- Loading State -->
      <div *ngIf="isLoading" class="loading-container">
        <div class="spinner"></div>
        <p>Loading dashboard...</p>
      </div>

      <!-- Overview Section -->
      <div *ngIf="!isLoading && activeSection === 'overview'" class="content-section">
        <div class="page-header">
          <div>
            <h1>Dashboard Overview</h1>
            <p class="page-subtitle">Welcome to your client portal</p>
          </div>
        </div>

        <!-- Stats Grid -->
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-header">
              <span class="stat-icon">‚è≥</span>
            </div>
            <div class="stat-value">{{ getPendingReviewsCount() }}</div>
            <div class="stat-label">Pending Reviews</div>
          </div>
          
          <div class="stat-card">
            <div class="stat-header">
              <span class="stat-icon">üíº</span>
            </div>
            <div class="stat-value">{{ jobRequests.length }}</div>
            <div class="stat-label">Active Positions</div>
          </div>
          
          <div class="stat-card">
            <div class="stat-header">
              <span class="stat-icon">üë•</span>
            </div>
            <div class="stat-value">{{ scheduledInterviews.length }}</div>
            <div class="stat-label">Scheduled Interviews</div>
          </div>
          
          <div class="stat-card">
            <div class="stat-header">
              <span class="stat-icon">‚úÖ</span>
            </div>
            <div class="stat-value">{{ getHiredCount() }}</div>
            <div class="stat-label">Recent Hires</div>
          </div>
        </div>

        <!-- Dashboard Grid -->
        <div class="dashboard-grid">
          <div class="card recent-candidates">
            <div class="card-header">
              <h3>Recent Candidates</h3>
              <a (click)="setActiveSection('submissions')">View All</a>
            </div>
            <div class="candidate-list">
              <div *ngIf="candidateSubmissions.length === 0" class="empty-state">
                <p>No recent candidates</p>
              </div>
            </div>
          </div>

          <div class="card active-jobs">
            <div class="card-header">
              <h3>Active Positions</h3>
              <a (click)="setActiveSection('positions')">View All</a>
            </div>
            <div class="job-list">
              <div *ngIf="jobRequests.length === 0" class="empty-state">
                <p>No active positions</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Candidate Submissions Section -->
      <div *ngIf="activeSection === 'submissions'" class="content-section">
        <div class="page-header">
          <div>
            <h1>Candidate Submissions</h1>
            <p class="page-subtitle">Review candidates submitted by your recruiter</p>
          </div>
        </div>
        

        
        <div class="submissions-container">
          <div *ngIf="candidateSubmissions.length === 0" class="empty-state">
            <span class="empty-icon">üë§</span>
            <h3>No Candidate Submissions</h3>
            <p>Your recruiter hasn't submitted any candidates yet.</p>
          </div>

          <div *ngIf="candidateSubmissions.length > 0" class="submissions-grid">
            <div class="card candidate-submission" *ngFor="let submission of candidateSubmissions">
              <div class="submission-header">
                <div class="candidate-basic-info">
                  <div class="candidate-avatar large">{{ getInitials(submission.candidateName) }}</div>
                  <div class="candidate-details">
                    <h3>{{ submission.candidateName }}</h3>
                    <p class="position">{{ submission.position }}</p>
                    <p class="recruiter">Submitted by: {{ submission.recruiterName }}</p>
                  </div>
                </div>
                <span class="status-badge" [class]="submission.status.toLowerCase()">{{ submission.status }}</span>
              </div>
              
              <div class="candidate-summary">
                <div class="summary-grid">
                  <div class="summary-item">
                    <span class="label">Experience:</span>
                    <span class="value">{{ submission.experience }}</span>
                  </div>
                  <div class="summary-item">
                    <span class="label">Current Company:</span>
                    <span class="value">{{ submission.currentCompany }}</span>
                  </div>
                  <div class="summary-item">
                    <span class="label">Education:</span>
                    <span class="value">{{ submission.education }}</span>
                  </div>
                  <div class="summary-item">
                    <span class="label">Expected Salary:</span>
                    <span class="value">{{ submission.expectedSalary }}</span>
                  </div>
                </div>
                
                <div class="key-strengths">
                  <span class="label">Key Strengths</span>
                  <div class="strengths-tags">
                    <span class="strength-tag" *ngFor="let strength of submission.keyStrengths">{{ strength }}</span>
                  </div>
                </div>
                
                <div class="recruiter-assessment">
                  <span class="assessment-label">Recruiter Rating:</span>
                  <span class="rating-badge">{{ submission.recruiterRating }}</span>
                </div>
              </div>
              
              <div class="candidate-actions">
                <div class="document-actions">
                  <button class="btn-document" (click)="previewResume(submission); $event.preventDefault()">
                    üìÑ View Resume
                  </button>
                  <button class="btn-document" *ngIf="submission.portfolioUrl" (click)="viewPortfolio(submission); $event.preventDefault()">
                    üîó Portfolio
                  </button>
                </div>
                <div class="decision-actions" *ngIf="submission.status === 'SUBMITTED'">
                  <button class="btn-approve" (click)="moveToInterview(submission)">
                    ‚úì Move to Interview
                  </button>
                  <button class="btn-hold" (click)="putOnHold(submission)">
                    ‚è∏ Put on Hold
                  </button>
                  <button class="btn-reject" (click)="rejectCandidate(submission)">
                    ‚úó Reject
                  </button>
                </div>
              </div>
              
            </div>
          </div>
        </div>
      </div>

      <!-- Approved Candidates Section -->
      <div *ngIf="activeSection === 'approved'" class="content-section">
        <div class="page-header">
          <div>
            <h1>Approved Candidates</h1>
            <p class="page-subtitle">Track candidates you approved for interview</p>
          </div>
        </div>
        <div *ngIf="approvedCandidates.length === 0" class="empty-state">
          <span class="empty-icon">‚úÖ</span>
          <h3>No Approved Candidates</h3>
          <p>Candidates you approve will appear here</p>
        </div>
        <div *ngIf="approvedCandidates.length > 0" class="approved-candidates-list">
          <div class="candidate-progress-card" *ngFor="let candidate of approvedCandidates">
            <div class="candidate-header">
              <div class="candidate-info">
                <div class="candidate-avatar">{{ getInitials(candidate.candidateName) }}</div>
                <div>
                  <h3>{{ candidate.candidateName }}</h3>
                  <p class="position">{{ candidate.jobTitle }}</p>
                </div>
              </div>
              <span class="status-badge" [ngClass]="getStatusClass(candidate.status)">{{ formatStatus(candidate.status) }}</span>
            </div>
            
            <div class="progress-timeline">
              <div class="timeline-step" [class.completed]="isStepCompleted(candidate.status, 'CLIENT_INTERVIEW')" [class.current]="candidate.status === 'CLIENT_INTERVIEW'">
                <div class="step-icon">üìÖ</div>
                <div class="step-info">
                  <div class="step-label">Interview</div>
                  <div class="step-date" *ngIf="candidate.status === 'CLIENT_INTERVIEW'">{{ candidate.updatedAt | date:'MMM d' }}</div>
                </div>
              </div>
              
              <div class="timeline-connector" [class.completed]="isStepCompleted(candidate.status, 'REFERENCE_CHECK')"></div>
              
              <div class="timeline-step" [class.completed]="isStepCompleted(candidate.status, 'REFERENCE_CHECK')" [class.current]="candidate.status === 'REFERENCE_CHECK'">
                <div class="step-icon">üìã</div>
                <div class="step-info">
                  <div class="step-label">References</div>
                  <div class="step-date" *ngIf="candidate.status === 'REFERENCE_CHECK'">{{ candidate.updatedAt | date:'MMM d' }}</div>
                </div>
              </div>
              
              <div class="timeline-connector" [class.completed]="isStepCompleted(candidate.status, 'BACKGROUND_CHECK')"></div>
              
              <div class="timeline-step" [class.completed]="isStepCompleted(candidate.status, 'BACKGROUND_CHECK')" [class.current]="candidate.status === 'BACKGROUND_CHECK'">
                <div class="step-icon">üîç</div>
                <div class="step-info">
                  <div class="step-label">Background</div>
                  <div class="step-date" *ngIf="candidate.status === 'BACKGROUND_CHECK'">{{ candidate.updatedAt | date:'MMM d' }}</div>
                </div>
              </div>
              
              <div class="timeline-connector" [class.completed]="isStepCompleted(candidate.status, 'OFFER_PENDING')"></div>
              
              <div class="timeline-step" [class.completed]="isStepCompleted(candidate.status, 'OFFER_PENDING')" [class.current]="candidate.status === 'OFFER_PENDING'">
                <div class="step-icon">üìÑ</div>
                <div class="step-info">
                  <div class="step-label">Offer</div>
                  <div class="step-date" *ngIf="candidate.status === 'OFFER_PENDING'">{{ candidate.updatedAt | date:'MMM d' }}</div>
                </div>
              </div>
              
              <div class="timeline-connector" [class.completed]="candidate.status === 'HIRED'"></div>
              
              <div class="timeline-step" [class.completed]="candidate.status === 'HIRED'" [class.current]="candidate.status === 'HIRED'">
                <div class="step-icon">‚úÖ</div>
                <div class="step-info">
                  <div class="step-label">Hired</div>
                  <div class="step-date" *ngIf="candidate.status === 'HIRED'">{{ candidate.updatedAt | date:'MMM d' }}</div>
                </div>
              </div>
            </div>
            
            <div class="candidate-footer">
              <span class="last-update">Last updated: {{ candidate.updatedAt | date:'MMM d, yyyy' }}</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Other Sections -->
      <div *ngIf="activeSection === 'positions'" class="content-section">
        <div class="page-header">
          <div>
            <h1>Job Requests</h1>
            <p class="page-subtitle">Manage your hiring requests and open positions</p>
          </div>
          <button class="btn-primary" (click)="openJobRequestForm()">
            ‚ûï Request New Position
          </button>
        </div>
        
        <!-- Job Request Details Modal -->
        <div *ngIf="showJobRequestDetails && selectedJobRequest" class="job-request-form-container">
          <div class="form-card">
            <div class="form-header">
              <h2>Job Request Details</h2>
              <button class="close-btn" (click)="closeJobRequestDetails()">‚úï</button>
            </div>
            <div class="job-request-details-content">
              <div class="detail-section" *ngIf="selectedJobRequest.requestId">
                <div class="request-id-banner">
                  <strong>Request ID:</strong> <code style="font-size: 1.1em; padding: 4px 8px; background: #f0f0f0; border-radius: 4px;">{{ selectedJobRequest.requestId }}</code>
                </div>
              </div>
              <div class="detail-section">
                <h3>Position Information</h3>
                <div class="detail-row"><strong>Title:</strong> {{ selectedJobRequest.title }}</div>
                <div class="detail-row"><strong>Department:</strong> {{ selectedJobRequest.department }}</div>
                <div class="detail-row"><strong>Location:</strong> {{ selectedJobRequest.location }}</div>
                <div class="detail-row"><strong>Employment Type:</strong> {{ selectedJobRequest.employmentType }}</div>
                <div class="detail-row"><strong>Priority:</strong> {{ selectedJobRequest.priority }}</div>
                <div class="detail-row"><strong>Number of Openings:</strong> {{ selectedJobRequest.numberOfOpenings }}</div>
                <div class="detail-row"><strong>Salary Range:</strong> {{ selectedJobRequest.salaryRange }}</div>
              </div>
              <div class="detail-section">
                <h3>Description</h3>
                <p>{{ selectedJobRequest.description }}</p>
              </div>
              <div class="detail-section">
                <h3>Requirements</h3>
                <p style="white-space: pre-wrap;">{{ selectedJobRequest.requirements }}</p>
              </div>
              <div class="detail-section">
                <h3>Status</h3>
                <div class="detail-row"><strong>Current Status:</strong> <span class="status-badge" [class]="selectedJobRequest.status.toLowerCase()">{{ selectedJobRequest.status }}</span></div>
                <div class="detail-row"><strong>Requested Date:</strong> {{ selectedJobRequest.createdAt | date:'MMM d, yyyy' }}</div>
              </div>
            </div>
          </div>
        </div>

        <div *ngIf="!showJobRequestForm && !showJobRequestDetails" class="job-requests-list">
          <div *ngIf="jobRequests.length === 0" class="empty-state">
            <span class="empty-icon">üíº</span>
            <h3>No Job Requests</h3>
            <p>You haven't submitted any job requests yet.</p>
          </div>
          <div class="card job-request-card" *ngFor="let job of jobRequests">
            <div class="job-request-header">
              <div>
                <h3>{{ job.title }}</h3>
                <p class="job-meta">{{ job.department }} ‚Ä¢ {{ job.location }}</p>
                <p class="request-id" *ngIf="job.requestId" style="margin-top: 4px;"><small>Request ID: <code>{{ job.requestId }}</code></small></p>
              </div>
              <span class="status-badge" [class]="job.status.toLowerCase()">{{ job.status }}</span>
            </div>
            <div class="job-request-details">
              <div class="detail-item">
                <span class="label">Requested:</span>
                <span class="value">{{ job.createdAt | date:'MMM d, yyyy' }}</span>
              </div>
              <div class="detail-item">
                <span class="label">Status:</span>
                <span class="value">{{ job.status }}</span>
              </div>
            </div>
            <div class="job-request-actions">
              <button class="btn-secondary" (click)="viewJobDetails(job)">View Details</button>

            </div>
          </div>
        </div>

        <!-- Job Request Form -->
        <div *ngIf="showJobRequestForm" class="job-request-form-container">
          <div class="form-card">
            <div class="form-header">
              <h2>Request New Position</h2>
              <button class="close-btn" (click)="closeJobRequestForm()">‚úï</button>
            </div>
            
            <form class="job-request-form">
              <div class="form-section">
                <h3>Position Details</h3>
                <div class="form-row">
                  <div class="form-group">
                    <label>Job Title *</label>
                    <input type="text" [(ngModel)]="jobRequest.title" name="title" placeholder="e.g. Senior Software Engineer" required>
                  </div>
                  <div class="form-group">
                    <label>Department *</label>
                    <input type="text" [(ngModel)]="jobRequest.department" name="department" placeholder="e.g. Engineering" required>
                  </div>
                </div>
                
                <div class="form-row">
                  <div class="form-group">
                    <label>Location *</label>
                    <input type="text" [(ngModel)]="jobRequest.location" name="location" placeholder="e.g. Remote, New York, Hybrid" required>
                  </div>
                  <div class="form-group">
                    <label>Employment Type *</label>
                    <select [(ngModel)]="jobRequest.employmentType" name="employmentType" required>
                      <option value="">Select type</option>
                      <option value="FULL_TIME">Full-time</option>
                      <option value="PART_TIME">Part-time</option>
                      <option value="CONTRACT">Contract</option>
                      <option value="TEMPORARY">Temporary</option>
                    </select>
                  </div>
                </div>

                <div class="form-row">
                  <div class="form-group">
                    <label>Number of Openings *</label>
                    <input type="number" [(ngModel)]="jobRequest.openings" name="openings" min="1" value="1" required>
                  </div>
                  <div class="form-group">
                    <label>Priority *</label>
                    <select [(ngModel)]="jobRequest.priority" name="priority" required>
                      <option value="">Select priority</option>
                      <option value="URGENT">High - Urgent</option>
                      <option value="HIGH">High</option>
                      <option value="MEDIUM">Medium - Normal</option>
                      <option value="LOW">Low - When possible</option>
                    </select>
                  </div>
                </div>
              </div>

              <div class="form-section">
                <h3>Compensation</h3>
                <div class="form-row">
                  <div class="form-group">
                    <label>Salary Range *</label>
                    <input type="text" [(ngModel)]="jobRequest.salaryRange" name="salaryRange" placeholder="e.g. $120,000 - $150,000" required>
                  </div>
                  <div class="form-group">
                    <label>Benefits</label>
                    <input type="text" [(ngModel)]="jobRequest.benefits" name="benefits" placeholder="e.g. Health, 401k, Stock options">
                  </div>
                </div>
              </div>

              <div class="form-section">
                <h3>Requirements</h3>
                <div class="form-group full-width">
                  <label>Job Description *</label>
                  <textarea [(ngModel)]="jobRequest.description" name="description" rows="4" placeholder="Describe the role, responsibilities, and what the candidate will be doing..." required></textarea>
                </div>
                
                <div class="form-group full-width">
                  <label>Required Skills & Qualifications *</label>
                  <textarea [(ngModel)]="jobRequest.requirements" name="requirements" rows="4" placeholder="List required skills, experience, education, certifications..." required></textarea>
                </div>
                
                <div class="form-group full-width">
                  <label>Preferred Qualifications</label>
                  <textarea [(ngModel)]="jobRequest.preferredQualifications" name="preferredQualifications" rows="3" placeholder="Nice-to-have skills or experience..."></textarea>
                </div>
              </div>

              <div class="form-section">
                <h3>Timeline & Additional Info</h3>
                <div class="form-row">
                  <div class="form-group">
                    <label>Target Start Date</label>
                    <input type="date" [(ngModel)]="jobRequest.startDate" name="startDate">
                  </div>
                  <div class="form-group">
                    <label>Hiring Manager</label>
                    <input type="text" [(ngModel)]="jobRequest.hiringManager" name="hiringManager" placeholder="Your name or hiring manager name">
                  </div>
                </div>
                
                <div class="form-group full-width">
                  <label>Additional Notes</label>
                  <textarea [(ngModel)]="jobRequest.notes" name="notes" rows="3" placeholder="Any additional information for the recruiter..."></textarea>
                </div>
              </div>

              <div class="form-actions">
                <button type="button" class="btn-secondary" (click)="closeJobRequestForm()">Cancel</button>
                <button type="submit" class="btn-primary" [disabled]="!isJobRequestFormValid()" (click)="submitJobRequest($event)">Submit Request</button>
              </div>
            </form>
          </div>
        </div>
      </div>

      <div *ngIf="activeSection === 'candidates'" class="content-section">
        <div class="page-header">
          <div>
            <h1>Candidates</h1>
            <p class="page-subtitle">Browse and manage candidates</p>
          </div>
        </div>
        
        <div class="candidates-grid">
          <div *ngIf="candidateSubmissions.length === 0" class="empty-state">
            <span class="empty-icon">üë§</span>
            <h3>No Candidates</h3>
            <p>No candidates available</p>
          </div>
        </div>
      </div>

      <div *ngIf="activeSection === 'interviews'" class="content-section">
        <div class="page-header">
          <div>
            <h1>My Interviews</h1>
            <p class="page-subtitle">Upcoming candidate interviews</p>
          </div>
        </div>
        

        
        <div class="interviews-container">
          <div *ngIf="scheduledInterviews.length === 0" class="empty-state">
            <span class="empty-icon">üìÖ</span>
            <h3>No Scheduled Interviews</h3>
            <p>Your recruiter will coordinate interview scheduling.</p>
          </div>

          <div *ngIf="scheduledInterviews.length > 0" class="interviews-list">
            <div class="interview-card" *ngFor="let interview of scheduledInterviews">
              <div class="interview-main">
                <div class="interview-datetime">
                  <div class="date">{{ interview.date }}</div>
                  <div class="time">{{ interview.time }}</div>
                  <div class="duration">{{ interview.duration }}</div>
                </div>
                
                <div class="interview-details">
                  <div class="candidate-info">
                    <div class="candidate-avatar">{{ getInitials(interview.candidateName) }}</div>
                    <div class="candidate-data">
                      <h3>{{ interview.candidateName }}</h3>
                      <p class="position">{{ interview.position }}</p>
                      <p class="interview-type">{{ interview.type }} ‚Ä¢ {{ interview.round }}</p>
                    </div>
                  </div>
                  
                  <div class="interview-meta">
                    <div class="interviewer-list">
                      <span class="label">Interviewers:</span>
                      <span class="interviewers">{{ interview.interviewers.join(', ') }}</span>
                    </div>
                    <div class="location" *ngIf="interview.location">
                      <span class="label">Location:</span>
                      <span>{{ interview.location }}</span>
                    </div>
                  </div>
                </div>
              </div>
              
              <div class="meeting-details">
                <div class="meeting-info" *ngIf="interview.meetingLink">
                  <div class="meeting-details-box">
                    <div class="meeting-detail-row">
                      <span class="detail-label">Meeting Link:</span>
                      <a [href]="interview.meetingLink" target="_blank" class="meeting-link-text">{{ interview.meetingLink }}</a>
                    </div>
                    <div class="meeting-detail-row" *ngIf="interview.meetingId">
                      <span class="detail-label">Meeting ID:</span>
                      <span class="detail-value">{{ interview.meetingId }}</span>
                    </div>
                    <div class="meeting-detail-row" *ngIf="interview.passcode">
                      <span class="detail-label">Passcode:</span>
                      <span class="detail-value">{{ interview.passcode }}</span>
                    </div>
                    <button class="copy-all-btn" (click)="copyMeetingDetails(interview)">üìã Copy All Details</button>
                  </div>
                </div>
                
                <div class="location-info" *ngIf="interview.location">
                  <span class="label">Location:</span>
                  <span class="value">{{ interview.location }}</span>
                </div>
                
                <div class="interview-actions">
                  <button class="btn-secondary" (click)="viewCandidateProfile(interview)">
                    üë§ View Candidate Profile
                  </button>
                  <button class="btn-secondary" (click)="downloadCalendar(interview)">
                    üìÖ Add to Calendar
                  </button>
                </div>
              </div>
              
              <div class="interview-status" *ngIf="interview.status !== 'SCHEDULED'">
                <span class="status-indicator" [class]="interview.status.toLowerCase()">{{ interview.status }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div *ngIf="activeSection === 'feedback'" class="content-section">
        <div class="page-header">
          <div>
            <h1>Feedback & Notes</h1>
            <p class="page-subtitle">Communicate with your recruiter</p>
          </div>
          <button class="btn-primary" (click)="openFeedbackForm()">
            ‚úçÔ∏è Send Feedback
          </button>
        </div>

        <div *ngIf="!showFeedbackForm && !showThreadView" class="feedback-threads">
          <div class="thread-card" *ngFor="let thread of feedbackHistory" (click)="openThread(thread)">
            <div class="thread-header">
              <div class="thread-avatar">{{ getInitials(thread.candidateName || 'General') }}</div>
              <div class="thread-info">
                <h3>{{ thread.candidateName || 'General Discussion' }}</h3>
                <p class="thread-subtitle" *ngIf="thread.positionTitle">{{ thread.positionTitle }}</p>
              </div>
              <span class="message-count">{{ thread.messageCount }}</span>
            </div>
            <div class="thread-preview">
              <span class="preview-sender" [class.you]="thread.lastMessage.senderType === 'CLIENT'">
                {{ thread.lastMessage.senderType === 'CLIENT' ? 'You' : thread.lastMessage.senderName }}:
              </span>
              <span class="preview-text">{{ thread.lastMessage.message }}</span>
            </div>
            <div class="thread-footer">
              <span class="thread-date">{{ thread.lastMessage.date }}</span>
              <span class="unread-indicator" *ngIf="thread.lastMessage.status === 'Pending' && thread.lastMessage.senderType === 'RECRUITER'">‚óè</span>
            </div>
          </div>
          
          <div *ngIf="feedbackHistory.length === 0" class="empty-state">
            <span class="empty-icon">üí¨</span>
            <h3>No Messages Yet</h3>
            <p>Start a conversation with your recruiter</p>
          </div>
        </div>
        
        <div *ngIf="showThreadView && selectedThread" class="thread-view">
          <div class="thread-view-header">
            <button class="back-btn" (click)="closeThreadView()">‚Üê Back</button>
            <div class="thread-title">
              <h2>{{ selectedThread.candidateName || 'General Discussion' }}</h2>
              <p *ngIf="selectedThread.positionTitle">{{ selectedThread.positionTitle }}</p>
            </div>
            <button class="btn-primary" (click)="replyToThread()">Reply</button>
          </div>
          
          <div class="messages-container">
            <div class="message-bubble" *ngFor="let msg of selectedThread.messages" [class.sent]="msg.senderType === 'CLIENT'" [class.received]="msg.senderType === 'RECRUITER'">
              <div class="message-header">
                <span class="sender-name">{{ msg.senderType === 'CLIENT' ? 'You' : msg.senderName }}</span>
                <span class="message-time">{{ msg.date }} {{ msg.time }}</span>
              </div>
              <div class="message-content">
                <p>{{ msg.message }}</p>
              </div>
            </div>
          </div>
        </div>

        <div *ngIf="showFeedbackForm" class="feedback-form-container">
          <div class="form-card">
            <div class="form-header">
              <h2>Send Feedback to Recruiter</h2>
              <button class="close-btn" (click)="closeFeedbackForm()">‚úï</button>
            </div>
            
            <form class="feedback-form">
              <div class="form-section">
                <div class="form-group">
                  <label>Feedback Type *</label>
                  <select [(ngModel)]="feedbackData.type" name="type" (change)="onFeedbackTypeChange()" required>
                    <option value="">Select type</option>
                    <option value="Candidate">Candidate Feedback</option>
                    <option value="Position">Position/Job Request</option>
                    <option value="Process">Hiring Process</option>
                    <option value="General">General Inquiry</option>
                  </select>
                </div>

                <div class="form-group" *ngIf="feedbackData.type === 'Candidate'">
                  <label>Select Candidate *</label>
                  <select [(ngModel)]="feedbackData.candidateId" name="candidateId" (change)="onCandidateSelect()" required>
                    <option value="">Choose a candidate</option>
                    <optgroup label="Pending Review" *ngIf="candidateSubmissions.length > 0">
                      <option *ngFor="let candidate of candidateSubmissions" [value]="candidate.id">
                        {{ candidate.candidateName }} - {{ candidate.position }}
                      </option>
                    </optgroup>
                    <optgroup label="Approved Candidates" *ngIf="approvedCandidates.length > 0">
                      <option *ngFor="let candidate of approvedCandidates" [value]="candidate.id">
                        {{ candidate.candidateName }} - {{ candidate.jobTitle }}
                      </option>
                    </optgroup>
                  </select>
                </div>

                <div class="form-group" *ngIf="feedbackData.type === 'Position'">
                  <label>Select Position *</label>
                  <select [(ngModel)]="feedbackData.positionId" name="positionId" (change)="onPositionSelect()" required>
                    <option value="">Choose a position</option>
                    <option *ngFor="let job of jobRequests" [value]="job.title">
                      {{ job.title }} - {{ job.department }}
                    </option>
                  </select>
                </div>

                <div class="form-group" *ngIf="feedbackData.type === 'Candidate'">
                  <label>Feedback Category *</label>
                  <select [(ngModel)]="feedbackData.category" name="category" required>
                    <option value="">Select category</option>
                    <option value="Interested">‚úÖ Interested - Move Forward</option>
                    <option value="Not Interested">‚ùå Not Interested</option>
                    <option value="Need More Info">‚ùì Need More Information</option>
                    <option value="Schedule Interview">üìÖ Ready to Schedule Interview</option>
                    <option value="Concerns">‚ö†Ô∏è Have Concerns</option>
                  </select>
                </div>

                <div class="form-group">
                  <label>Subject *</label>
                  <input type="text" [(ngModel)]="feedbackData.subject" name="subject" placeholder="Brief subject line" required>
                </div>

                <div class="form-group full-width">
                  <label>Your Feedback/Notes *</label>
                  <textarea [(ngModel)]="feedbackData.message" name="message" rows="6" 
                    placeholder="Share your thoughts, questions, or feedback with your recruiter..." required></textarea>
                </div>

                <div class="form-group">
                  <label>Priority</label>
                  <select [(ngModel)]="feedbackData.priority" name="priority">
                    <option value="Normal">Normal</option>
                    <option value="High">High - Needs Quick Response</option>
                    <option value="Urgent">Urgent - Time Sensitive</option>
                  </select>
                </div>
              </div>

              <div class="form-actions">
                <button type="button" class="btn-secondary" (click)="closeFeedbackForm()">Cancel</button>
                <button type="button" class="btn-primary" (click)="submitFeedback($event)">Send Feedback</button>
              </div>
            </form>
          </div>
        </div>
      </div>

      <div *ngIf="activeSection === 'reports'" class="content-section">
        <div class="page-header">
          <div>
            <h1>Reports & Analytics</h1>
            <p class="page-subtitle">Track your hiring performance</p>
          </div>
        </div>
        
        <div class="reports-grid">
          <div class="card report-card">
            <h3>üìä Hiring Metrics</h3>
            <p>Track time-to-hire, conversion rates, and more</p>
            <button class="btn-primary">View Report</button>
          </div>
          
          <div class="card report-card">
            <h3>üí∞ Cost Analysis</h3>
            <p>Analyze hiring costs and ROI</p>
            <button class="btn-primary">View Report</button>
          </div>
          
          <div class="card report-card">
            <h3>üìà Pipeline Analytics</h3>
            <p>Monitor candidate pipeline performance</p>
            <button class="btn-primary">View Report</button>
          </div>
        </div>
      </div>

      <div *ngIf="activeSection === 'settings'" class="content-section">
        <div class="page-header">
          <div>
            <h1>Settings</h1>
            <p class="page-subtitle">Manage your account and preferences</p>
          </div>
        </div>
        
        <div class="settings-tabs">
          <button class="tab-btn" [class.active]="settingsTab === 'account'" (click)="settingsTab = 'account'">Account</button>
          <button class="tab-btn" [class.active]="settingsTab === 'notifications'" (click)="settingsTab = 'notifications'">Notifications</button>
          <button class="tab-btn" [class.active]="settingsTab === 'preferences'" (click)="settingsTab = 'preferences'">Preferences</button>
        </div>
        
        <div class="settings-container">
          <!-- Account Settings -->
          <div *ngIf="settingsTab === 'account'">
            <div class="card settings-card">
              <h3>üë§ Profile Information</h3>
              <p class="settings-description">Update your personal information</p>
              
              <div class="form-section">
                <div class="form-row">
                  <div class="form-group">
                    <label>Full Name</label>
                    <input type="text" [(ngModel)]="accountSettings.fullName" placeholder="Your full name">
                  </div>
                  <div class="form-group">
                    <label>Email Address</label>
                    <input type="email" [(ngModel)]="accountSettings.email" placeholder="your.email@company.com" disabled>
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group">
                    <label>Company Name</label>
                    <input type="text" [(ngModel)]="accountSettings.companyName" placeholder="Your company">
                  </div>
                  <div class="form-group">
                    <label>Job Title</label>
                    <input type="text" [(ngModel)]="accountSettings.jobTitle" placeholder="e.g. Hiring Manager">
                  </div>
                </div>
                <div class="form-group">
                  <label>Phone Number</label>
                  <input type="tel" [(ngModel)]="accountSettings.phone" placeholder="+1 (555) 000-0000">
                </div>
                <button class="btn-primary" (click)="saveAccountSettings()">Save Changes</button>
              </div>
            </div>
            
            <div class="card settings-card">
              <h3>üîí Change Password</h3>
              <p class="settings-description">Update your login password</p>
              
              <div class="form-section">
                <div class="form-group">
                  <label>Current Password</label>
                  <input type="password" [(ngModel)]="passwordChange.currentPassword" placeholder="Enter current password">
                </div>
                <div class="form-group">
                  <label>New Password</label>
                  <input type="password" [(ngModel)]="passwordChange.newPassword" placeholder="Enter new password">
                </div>
                <div class="form-group">
                  <label>Confirm New Password</label>
                  <input type="password" [(ngModel)]="passwordChange.confirmPassword" placeholder="Confirm new password">
                </div>
                <button class="btn-primary" (click)="changePassword()">Update Password</button>
              </div>
            </div>
          </div>
          
          <!-- Notification Settings -->
          <div *ngIf="settingsTab === 'notifications'">
          <div class="card settings-card">
            <h3>üìß Email Notifications</h3>
            <p class="settings-description">Choose which updates you want to receive via email</p>
            
            <div class="settings-list">
              <div class="setting-item">
                <div class="setting-info">
                  <strong>New Candidate Submissions</strong>
                  <p>Get notified when recruiter submits a new candidate for your review</p>
                </div>
                <label class="toggle-switch">
                  <input type="checkbox" [(ngModel)]="emailSettings.newCandidates" (change)="saveEmailSettings()">
                  <span class="slider"></span>
                </label>
              </div>
              
              <div class="setting-item">
                <div class="setting-info">
                  <strong>Interview Scheduled</strong>
                  <p>Receive email when an interview is scheduled or rescheduled</p>
                </div>
                <label class="toggle-switch">
                  <input type="checkbox" [(ngModel)]="emailSettings.interviewScheduled" (change)="saveEmailSettings()">
                  <span class="slider"></span>
                </label>
              </div>
              
              <div class="setting-item">
                <div class="setting-info">
                  <strong>Job Request Updates</strong>
                  <p>Get updates on your job posting status and candidate progress</p>
                </div>
                <label class="toggle-switch">
                  <input type="checkbox" [(ngModel)]="emailSettings.jobUpdates" (change)="saveEmailSettings()">
                  <span class="slider"></span>
                </label>
              </div>
              
              <div class="setting-item">
                <div class="setting-info">
                  <strong>Candidate Status Changes</strong>
                  <p>Notify when candidate moves to different stage (interview, offer, hired)</p>
                </div>
                <label class="toggle-switch">
                  <input type="checkbox" [(ngModel)]="emailSettings.candidateStatusChange" (change)="saveEmailSettings()">
                  <span class="slider"></span>
                </label>
              </div>
              
              <div class="setting-item">
                <div class="setting-info">
                  <strong>Recruiter Messages</strong>
                  <p>Receive email when recruiter responds to your feedback or messages</p>
                </div>
                <label class="toggle-switch">
                  <input type="checkbox" [(ngModel)]="emailSettings.recruiterMessages" (change)="saveEmailSettings()">
                  <span class="slider"></span>
                </label>
              </div>
              
              <div class="setting-item">
                <div class="setting-info">
                  <strong>Daily Summary</strong>
                  <p>Get a daily digest of all activities and pending actions</p>
                </div>
                <label class="toggle-switch">
                  <input type="checkbox" [(ngModel)]="emailSettings.dailySummary" (change)="saveEmailSettings()">
                  <span class="slider"></span>
                </label>
              </div>
            </div>
          </div>
          
          <div class="card settings-card">
            <h3>üîî In-App Notifications</h3>
            <p class="settings-description">Control notifications within the portal</p>
            
            <div class="settings-list">
              <div class="setting-item">
                <div class="setting-info">
                  <strong>Push Notifications</strong>
                  <p>Show browser notifications for important updates</p>
                </div>
                <label class="toggle-switch">
                  <input type="checkbox" [(ngModel)]="notificationSettings.pushEnabled" (change)="saveNotificationSettings()">
                  <span class="slider"></span>
                </label>
              </div>
              
              <div class="setting-item">
                <div class="setting-info">
                  <strong>Sound Alerts</strong>
                  <p>Play sound when new notification arrives</p>
                </div>
                <label class="toggle-switch">
                  <input type="checkbox" [(ngModel)]="notificationSettings.soundEnabled" (change)="saveNotificationSettings()">
                  <span class="slider"></span>
                </label>
              </div>
            </div>
          </div>
          </div>
          
          <!-- Preferences -->
          <div *ngIf="settingsTab === 'preferences'">
            <div class="card settings-card">
              <h3>üé® Display Preferences</h3>
              <p class="settings-description">Customize your portal appearance</p>
              
              <div class="settings-list">
                <div class="setting-item">
                  <div class="setting-info">
                    <strong>Theme</strong>
                    <p>Choose your preferred color theme</p>
                  </div>
                  <select [(ngModel)]="preferences.theme" (change)="savePreferences()" class="preference-select">
                    <option value="light">Light</option>
                    <option value="dark">Dark</option>
                    <option value="auto">Auto (System)</option>
                  </select>
                </div>
                
                <div class="setting-item">
                  <div class="setting-info">
                    <strong>Compact View</strong>
                    <p>Show more content with reduced spacing</p>
                  </div>
                  <label class="toggle-switch">
                    <input type="checkbox" [(ngModel)]="preferences.compactView" (change)="savePreferences()">
                    <span class="slider"></span>
                  </label>
                </div>
                
                <div class="setting-item">
                  <div class="setting-info">
                    <strong>Language</strong>
                    <p>Select your preferred language</p>
                  </div>
                  <select [(ngModel)]="preferences.language" (change)="savePreferences()" class="preference-select">
                    <option value="en">English</option>
                    <option value="es">Spanish</option>
                    <option value="fr">French</option>
                    <option value="de">German</option>
                  </select>
                </div>
                
                <div class="setting-item">
                  <div class="setting-info">
                    <strong>Date Format</strong>
                    <p>Choose how dates are displayed</p>
                  </div>
                  <select [(ngModel)]="preferences.dateFormat" (change)="savePreferences()" class="preference-select">
                    <option value="MM/DD/YYYY">MM/DD/YYYY</option>
                    <option value="DD/MM/YYYY">DD/MM/YYYY</option>
                    <option value="YYYY-MM-DD">YYYY-MM-DD</option>
                  </select>
                </div>
                
                <div class="setting-item">
                  <div class="setting-info">
                    <strong>Time Format</strong>
                    <p>12-hour or 24-hour time display</p>
                  </div>
                  <select [(ngModel)]="preferences.timeFormat" (change)="savePreferences()" class="preference-select">
                    <option value="12h">12-hour (2:00 PM)</option>
                    <option value="24h">24-hour (14:00)</option>
                  </select>
                </div>
                
                <div class="setting-item">
                  <div class="setting-info">
                    <strong>Items Per Page</strong>
                    <p>Default number of items to show in lists</p>
                  </div>
                  <select [(ngModel)]="preferences.itemsPerPage" (change)="savePreferences()" class="preference-select">
                    <option value="10">10</option>
                    <option value="25">25</option>
                    <option value="50">50</option>
                    <option value="100">100</option>
                  </select>
                </div>
              </div>
            </div>
            
            <div class="card settings-card">
              <h3>üì© Dashboard Preferences</h3>
              <p class="settings-description">Customize your dashboard view</p>
              
              <div class="settings-list">
                <div class="setting-item">
                  <div class="setting-info">
                    <strong>Show Statistics</strong>
                    <p>Display stats cards on dashboard</p>
                  </div>
                  <label class="toggle-switch">
                    <input type="checkbox" [(ngModel)]="preferences.showStats" (change)="savePreferences()">
                    <span class="slider"></span>
                  </label>
                </div>
                
                <div class="setting-item">
                  <div class="setting-info">
                    <strong>Show Recent Candidates</strong>
                    <p>Display recent candidate submissions on dashboard</p>
                  </div>
                  <label class="toggle-switch">
                    <input type="checkbox" [(ngModel)]="preferences.showRecentCandidates" (change)="savePreferences()">
                    <span class="slider"></span>
                  </label>
                </div>
                
                <div class="setting-item">
                  <div class="setting-info">
                    <strong>Show Active Positions</strong>
                    <p>Display active job positions on dashboard</p>
                  </div>
                  <label class="toggle-switch">
                    <input type="checkbox" [(ngModel)]="preferences.showActivePositions" (change)="savePreferences()">
                    <span class="slider"></span>
                  </label>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>
<!-- Approve Modal -->
<div *ngIf="showApproveModal" class="modal-overlay" (click)="closeActionModals()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>‚úì Approve Candidate</h2>
      <button class="close-btn" (click)="closeActionModals()">‚úï</button>
    </div>
    <div class="modal-body">
      <p><strong>{{ selectedSubmission?.candidateName }}</strong> for <strong>{{ selectedSubmission?.position }}</strong></p>
      
      <div class="form-group">
        <label>Why are you approving this candidate? *</label>
        <select [(ngModel)]="actionReason" class="form-control">
          <option value="">Select reason</option>
          <option value="Strong technical skills">Strong technical skills</option>
          <option value="Great culture fit">Great culture fit</option>
          <option value="Relevant experience">Relevant experience</option>
          <option value="Impressive background">Impressive background</option>
          <option value="Other">Other</option>
        </select>
      </div>
      
      <div class="form-group">
        <label>Additional notes (optional)</label>
        <textarea [(ngModel)]="actionNotes" rows="3" placeholder="Any specific areas to focus on during interview..."></textarea>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn-secondary" (click)="closeActionModals()">Cancel</button>
      <button class="btn-approve" (click)="confirmApprove()">Approve & Move to Interview</button>
    </div>
  </div>
</div>

<!-- Hold Modal -->
<div *ngIf="showHoldModal" class="modal-overlay" (click)="closeActionModals()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>‚è∏ Put on Hold</h2>
      <button class="close-btn" (click)="closeActionModals()">‚úï</button>
    </div>
    <div class="modal-body">
      <p><strong>{{ selectedSubmission?.candidateName }}</strong> for <strong>{{ selectedSubmission?.position }}</strong></p>
      
      <div class="form-group">
        <label>Reason for hold *</label>
        <select [(ngModel)]="actionReason" class="form-control">
          <option value="">Select reason</option>
          <option value="Reviewing other candidates">Reviewing other candidates</option>
          <option value="Need more information">Need more information</option>
          <option value="Budget pending approval">Budget pending approval</option>
          <option value="Hiring timeline changed">Hiring timeline changed</option>
          <option value="Other">Other</option>
        </select>
      </div>
      
      <div class="form-group">
        <label>Additional notes (optional)</label>
        <textarea [(ngModel)]="actionNotes" rows="3" placeholder="Any additional context..."></textarea>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn-secondary" (click)="closeActionModals()">Cancel</button>
      <button class="btn-hold" (click)="confirmHold()">Put on Hold</button>
    </div>
  </div>
</div>

<!-- Reject Modal -->
<div *ngIf="showRejectModal" class="modal-overlay" (click)="closeActionModals()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>‚úó Reject Candidate</h2>
      <button class="close-btn" (click)="closeActionModals()">‚úï</button>
    </div>
    <div class="modal-body">
      <p><strong>{{ selectedSubmission?.candidateName }}</strong> for <strong>{{ selectedSubmission?.position }}</strong></p>
      
      <div class="form-group">
        <label>Reason for rejection *</label>
        <select [(ngModel)]="actionReason" class="form-control">
          <option value="">Select reason</option>
          <option value="Not qualified">Not qualified for the role</option>
          <option value="Overqualified">Overqualified</option>
          <option value="Salary expectations too high">Salary expectations too high</option>
          <option value="Culture fit concerns">Culture fit concerns</option>
          <option value="Found better candidate">Found a better candidate</option>
          <option value="Position filled">Position already filled</option>
          <option value="Other">Other</option>
        </select>
      </div>
      
      <div class="form-group">
        <label>Feedback for recruiter (optional but recommended)</label>
        <textarea [(ngModel)]="actionNotes" rows="3" placeholder="This feedback helps the recruiter understand your requirements better..."></textarea>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn-secondary" (click)="closeActionModals()">Cancel</button>
      <button class="btn-reject" (click)="confirmReject()">Reject Candidate</button>
    </div>
  </div>
</div>
