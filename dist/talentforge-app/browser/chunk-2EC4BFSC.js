import{a as F}from"./chunk-MX3KJ2PE.js";import{a as P}from"./chunk-OBD3CFZT.js";import{f as A,g as O,h as L,i as N,k as U}from"./chunk-AHQOJUUW.js";import{$b as r,Bb as c,Da as p,Db as D,E as k,Ea as f,Jb as i,Kb as o,Lb as M,Nb as v,Oc as w,Pc as S,Qb as g,Sb as l,Tc as _,ac as m,ca as T,gb as s,ha as E,hb as d,ic as b,j as y,ua as x,zb as u}from"./chunk-EGDJTDOV.js";function G(n,h){if(n&1){let t=v();i(0,"div",1)(1,"div",2)(2,"div",3),r(3,"\u23F0"),o(),i(4,"h2"),r(5,"Session Expiring Soon"),o(),i(6,"p"),r(7,"Your session will expire in:"),o(),i(8,"div",4),r(9),o(),i(10,"p",5),r(11,"You will be automatically logged out for security reasons."),o(),i(12,"div",6)(13,"button",7),g("click",function(){p(t);let a=l();return f(a.extendSession())}),r(14,"Stay Logged In"),o(),i(15,"button",8),g("click",function(){p(t);let a=l();return f(a.logout())}),r(16,"Logout Now"),o()()()()}if(n&2){let t=l();s(9),m(t.remainingTime)}}var j=(()=>{class n{constructor(t,e){this.router=t,this.authService=e,this.showWarning=!1,this.remainingTime="",this.warningTime=5*60*1e3,this.sessionDuration=30*60*1e3,this.extendedSessionDuration=30*24*60*60*1e3,this.lastActivityTime=Date.now()}ngOnInit(){this.checkRememberMe(),this.startActivityTracking(),this.startSessionCheck()}checkRememberMe(){let t=localStorage.getItem("rememberMe"),e=localStorage.getItem("rememberMeExpiry");if(t==="true"&&e){let a=parseInt(e);Date.now()<a?this.sessionDuration=this.extendedSessionDuration:(localStorage.removeItem("rememberMe"),localStorage.removeItem("rememberMeExpiry"))}}ngOnDestroy(){this.checkInterval?.unsubscribe(),this.countdownInterval?.unsubscribe()}startActivityTracking(){["mousedown","keydown","scroll","touchstart"].forEach(t=>{document.addEventListener(t,()=>this.updateActivity(),!0)})}updateActivity(){this.showWarning||(this.lastActivityTime=Date.now())}startSessionCheck(){this.checkInterval=k(1e3).subscribe(()=>{let t=Date.now()-this.lastActivityTime,e=this.sessionDuration-t;e<=0?this.forceLogout():e<=this.warningTime&&!this.showWarning&&(this.showWarning=!0,this.startCountdown())})}startCountdown(){this.countdownInterval=k(1e3).subscribe(()=>{let t=Date.now()-this.lastActivityTime,e=this.sessionDuration-t;if(e<=0)this.forceLogout();else{let a=Math.floor(e/6e4),C=Math.floor(e%6e4/1e3);this.remainingTime=`${a}:${C.toString().padStart(2,"0")}`}})}extendSession(){this.lastActivityTime=Date.now(),this.showWarning=!1,this.countdownInterval?.unsubscribe()}logout(){this.checkInterval?.unsubscribe(),this.countdownInterval?.unsubscribe(),this.authService.logout(),this.router.navigate(["/auth/login"])}forceLogout(){this.checkInterval?.unsubscribe(),this.countdownInterval?.unsubscribe(),this.authService.logout(),this.router.navigate(["/auth/login"],{queryParams:{reason:"session-expired"}})}static{this.\u0275fac=function(e){return new(e||n)(d(O),d(P))}}static{this.\u0275cmp=x({type:n,selectors:[["app-session-timeout"]],standalone:!0,features:[b],decls:1,vars:1,consts:[["class","session-warning-overlay",4,"ngIf"],[1,"session-warning-overlay"],[1,"session-warning-modal"],[1,"warning-icon"],[1,"countdown"],[1,"hint"],[1,"actions"],[1,"btn-primary",3,"click"],[1,"btn-secondary",3,"click"]],template:function(e,a){e&1&&u(0,G,17,1,"div",0),e&2&&c("ngIf",a.showWarning)},dependencies:[_,S],styles:[".session-warning-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#000000b3;display:flex;align-items:center;justify-content:center;z-index:10000;animation:_ngcontent-%COMP%_fadeIn .3s}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.session-warning-modal[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:2rem;max-width:400px;width:90%;text-align:center;box-shadow:0 20px 60px #0000004d;animation:_ngcontent-%COMP%_slideUp .3s}@keyframes _ngcontent-%COMP%_slideUp{0%{transform:translateY(20px);opacity:0}to{transform:translateY(0);opacity:1}}.warning-icon[_ngcontent-%COMP%]{font-size:4rem;margin-bottom:1rem;animation:_ngcontent-%COMP%_pulse 1.5s infinite}@keyframes _ngcontent-%COMP%_pulse{0%,to{transform:scale(1)}50%{transform:scale(1.1)}}h2[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:#0f172a;margin-bottom:.5rem}p[_ngcontent-%COMP%]{color:#64748b;margin-bottom:1rem}.countdown[_ngcontent-%COMP%]{font-size:3rem;font-weight:700;color:#ef4444;font-family:monospace;margin:1rem 0}.hint[_ngcontent-%COMP%]{font-size:.875rem;margin-bottom:1.5rem}.actions[_ngcontent-%COMP%]{display:flex;gap:1rem}.btn-primary[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%]{flex:1;padding:12px;border:none;border-radius:8px;font-weight:600;cursor:pointer;transition:all .2s}.btn-primary[_ngcontent-%COMP%]{background:#06f;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{background:#0052cc}.btn-secondary[_ngcontent-%COMP%]{background:#fff;color:#64748b;border:1px solid #e2e8f0}.btn-secondary[_ngcontent-%COMP%]:hover{background:#f8fafc}@media (max-width: 480px){.session-warning-modal[_ngcontent-%COMP%]{padding:1.5rem}.warning-icon[_ngcontent-%COMP%]{font-size:3rem}.countdown[_ngcontent-%COMP%]{font-size:2rem}.actions[_ngcontent-%COMP%]{flex-direction:column}}"]})}}return n})();var R=(()=>{class n{constructor(){this.toastSubject=new y,this.toasts$=this.toastSubject.asObservable(),this.idCounter=0}show(t,e="info",a){let C=e==="success"?5e3:e==="error"?8e3:5e3,V={id:this.idCounter++,message:t,type:e,duration:a||C};this.toastSubject.next(V)}success(t,e){this.show(t,"success",e)}error(t,e){this.show(t,"error",e)}info(t,e){this.show(t,"info",e)}warning(t,e){this.show(t,"warning",e)}static{this.\u0275fac=function(e){return new(e||n)}}static{this.\u0275prov=E({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function B(n,h){if(n&1){let t=v();i(0,"div",2)(1,"span",3),r(2),o(),i(3,"span",4),r(4),o(),i(5,"button",5),g("click",function(){let a=p(t).$implicit,C=l();return f(C.remove(a.id))}),r(6,"\u2715"),o()()}if(n&2){let t=h.$implicit,e=l();D("toast-"+t.type),c("@slideIn",void 0),s(2),m(e.getIcon(t.type)),s(2),m(t.message)}}var $=(()=>{class n{constructor(t){this.toastService=t,this.toasts=[]}ngOnInit(){this.toastService.toasts$.subscribe(t=>{this.toasts.push(t),setTimeout(()=>this.remove(t.id),t.duration)})}remove(t){this.toasts=this.toasts.filter(e=>e.id!==t)}getIcon(t){let e={success:"\u2705",error:"\u274C",warning:"\u26A0\uFE0F",info:"\u2139\uFE0F"};return e[t]||e.info}static{this.\u0275fac=function(e){return new(e||n)(d(R))}}static{this.\u0275cmp=x({type:n,selectors:[["app-toast"]],standalone:!0,features:[b],decls:2,vars:1,consts:[[1,"toast-container"],["class","toast",3,"class",4,"ngFor","ngForOf"],[1,"toast"],[1,"icon"],[1,"message"],[1,"close",3,"click"]],template:function(e,a){e&1&&(i(0,"div",0),u(1,B,7,5,"div",1),o()),e&2&&(s(),c("ngForOf",a.toasts))},dependencies:[_,w],styles:[".toast-container[_ngcontent-%COMP%]{position:fixed;top:20px;right:20px;z-index:10001;display:flex;flex-direction:column;gap:12px;max-width:400px}.toast[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:16px;border-radius:8px;box-shadow:0 4px 12px #00000026;animation:_ngcontent-%COMP%_slideIn .3s ease-out;min-width:300px}@keyframes _ngcontent-%COMP%_slideIn{0%{transform:translate(400px);opacity:0}to{transform:translate(0);opacity:1}}.toast-success[_ngcontent-%COMP%]{background:#d1fae5;border-left:4px solid #10b981;color:#065f46}.toast-error[_ngcontent-%COMP%]{background:#fee2e2;border-left:4px solid #ef4444;color:#991b1b}.toast-warning[_ngcontent-%COMP%]{background:#fef3c7;border-left:4px solid #f59e0b;color:#92400e}.toast-info[_ngcontent-%COMP%]{background:#dbeafe;border-left:4px solid #0066ff;color:#1e40af}.icon[_ngcontent-%COMP%]{font-size:1.25rem;flex-shrink:0}.message[_ngcontent-%COMP%]{flex:1;font-size:.875rem;font-weight:500}.close[_ngcontent-%COMP%]{background:none;border:none;font-size:1.25rem;cursor:pointer;opacity:.6;padding:0;width:24px;height:24px;flex-shrink:0}.close[_ngcontent-%COMP%]:hover{opacity:1}@media (max-width: 768px){.toast-container[_ngcontent-%COMP%]{left:20px;right:20px;max-width:none}.toast[_ngcontent-%COMP%]{min-width:auto}}"]})}}return n})();function H(n,h){n&1&&(i(0,"div",21),r(1,"Acme Recruiting"),o())}function J(n,h){if(n&1&&(i(0,"a",22)(1,"span",10),r(2),o(),i(3,"span"),r(4),o()()),n&2){let t=h.$implicit;c("routerLink",t.route),s(2),m(t.icon),s(2),m(t.label)}}function K(n,h){if(n&1){let t=v();i(0,"div",1),M(1,"app-session-timeout")(2,"app-toast"),i(3,"aside",2)(4,"div",3)(5,"div",4),r(6,"\u26A1 TalentForge"),o(),u(7,H,2,0,"div",5),o(),i(8,"nav",6),u(9,J,5,3,"a",7),o(),i(10,"div",8)(11,"a",9)(12,"span",10),r(13,"\u2699\uFE0F"),o(),i(14,"span"),r(15,"Settings"),o()(),i(16,"a",11),g("click",function(){p(t);let a=l();return f(a.logout())}),i(17,"span",10),r(18,"\u{1F6AA}"),o(),i(19,"span"),r(20,"Logout"),o()()()(),i(21,"main",12)(22,"header",13)(23,"div",14)(24,"span",10),r(25,"\u{1F50D}"),o(),M(26,"input",15),o(),i(27,"div",16)(28,"button",17),r(29,"\u{1F514}"),o(),i(30,"div",18)(31,"div",19),r(32),o(),i(33,"span"),r(34),o()()()(),i(35,"div",20),M(36,"router-outlet"),o()()()}if(n&2){let t=l();s(7),c("ngIf",t.showTenantName),s(2),c("ngForOf",t.navigationItems),s(17),c("placeholder",t.searchPlaceholder),s(6),m(t.userInitials),s(2),m(t.userName)}}var lt=(()=>{class n{constructor(t,e,a){this.router=t,this.authService=e,this.navigationService=a,this.currentUser=null,this.navigationItems=[],this.destroy$=new y}ngOnInit(){let t=this.authService.getCurrentUserValue();t&&(this.currentUser=t,this.navigationItems=this.navigationService.getNavigationForRole(t.role)),this.authService.currentUser$.pipe(T(this.destroy$)).subscribe(e=>{this.currentUser=e,e?this.navigationItems=this.navigationService.getNavigationForRole(e.role):this.navigationItems=[]})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}get userName(){return this.currentUser?`${this.currentUser.firstName} ${this.currentUser.lastName}`:"User"}get userInitials(){return this.currentUser?`${this.currentUser.firstName[0]}${this.currentUser.lastName[0]}`:"U"}get showTenantName(){return this.currentUser?this.navigationService.isTenantRole(this.currentUser.role):!1}get searchPlaceholder(){if(!this.currentUser)return"Search...";switch(this.currentUser.role){case"CANDIDATE":return"Search jobs or companies...";case"RECRUITER":return"Search candidates, jobs, or companies...";case"TENANT_ADMIN":return"Search team, jobs, or candidates...";case"PLATFORM_ADMIN":case"PLATFORM_SUPER_ADMIN":return"Search tenants...";case"BILLING_MANAGER":return"Search subscriptions or invoices...";default:return"Search..."}}logout(){this.authService.logout()}static{this.\u0275fac=function(e){return new(e||n)(d(O),d(P),d(F))}}static{this.\u0275cmp=x({type:n,selectors:[["app-main-layout"]],standalone:!0,features:[b],decls:1,vars:1,consts:[["class","layout",4,"ngIf"],[1,"layout"],[1,"sidebar"],[1,"logo-section"],[1,"logo"],["class","tenant-name",4,"ngIf"],[1,"nav-menu"],["class","nav-item","routerLinkActive","active",3,"routerLink",4,"ngFor","ngForOf"],[1,"sidebar-footer"],["routerLink","/settings","routerLinkActive","active",1,"nav-item"],[1,"icon"],[1,"nav-item",3,"click"],[1,"main-content"],[1,"top-bar"],[1,"search-bar"],["type","text",3,"placeholder"],[1,"top-actions"],[1,"icon-btn"],[1,"user-profile"],[1,"avatar"],[1,"content"],[1,"tenant-name"],["routerLinkActive","active",1,"nav-item",3,"routerLink"]],template:function(e,a){e&1&&u(0,K,37,5,"div",0),e&2&&c("ngIf",a.currentUser)},dependencies:[_,w,S,U,A,L,N,j,$],styles:[".layout[_ngcontent-%COMP%]{display:flex;min-height:100vh;background:#f8fafc;font-family:Inter,sans-serif}.sidebar[_ngcontent-%COMP%]{width:260px;background:#0f172a;color:#fff;display:flex;flex-direction:column;position:fixed;height:100vh;left:0;top:0;z-index:1000}.logo-section[_ngcontent-%COMP%]{padding:24px;border-bottom:1px solid rgba(255,255,255,.1)}.logo[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;background:linear-gradient(135deg,#06f,#00d4ff);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;margin-bottom:8px}.tenant-name[_ngcontent-%COMP%]{font-size:.75rem;color:#64748b;font-weight:500}.nav-menu[_ngcontent-%COMP%]{flex:1;padding:16px;overflow-y:auto}.nav-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px 16px;color:#94a3b8;text-decoration:none;border-radius:8px;margin-bottom:4px;transition:all .3s;cursor:pointer}.nav-item[_ngcontent-%COMP%]:hover{background:#ffffff1a;color:#fff}.nav-item.active[_ngcontent-%COMP%]{background:#06f;color:#fff}.nav-item[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{font-size:1.25rem}.sidebar-footer[_ngcontent-%COMP%]{padding:16px;border-top:1px solid rgba(255,255,255,.1)}.main-content[_ngcontent-%COMP%]{flex:1;margin-left:260px;display:flex;flex-direction:column;min-height:100vh}.top-bar[_ngcontent-%COMP%]{background:#fff;padding:16px 32px;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #e2e8f0;position:sticky;top:0;z-index:100}.search-bar[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;background:#f8fafc;padding:10px 16px;border-radius:8px;width:400px}.search-bar[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{font-size:1.25rem}.search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;background:transparent;outline:none;width:100%;font-size:.875rem}.top-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px}.icon-btn[_ngcontent-%COMP%]{background:#f8fafc;border:none;width:40px;height:40px;border-radius:8px;cursor:pointer;font-size:1.25rem;transition:all .3s}.icon-btn[_ngcontent-%COMP%]:hover{background:#e2e8f0}.user-profile[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;cursor:pointer}.avatar[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;background:linear-gradient(135deg,#06f,#00d4ff);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:600;font-size:.875rem}.content[_ngcontent-%COMP%]{flex:1}"]})}}return n})();export{lt as a};
