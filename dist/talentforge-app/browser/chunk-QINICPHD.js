import{a as A}from"./chunk-O5ZM3L5J.js";import{a as D}from"./chunk-JPQV322R.js";import{f as k,g as M,h as I,i as T,k as E}from"./chunk-UY2YNJ4I.js";import{Ca as g,D as w,Da as p,Hb as n,Ib as i,Jb as x,Kc as P,Lb as _,Lc as y,Ob as f,Oc as C,Qb as l,Yb as o,Zb as m,ba as O,eb as s,fb as d,fc as b,j as S,ta as v,xb as u,zb as c}from"./chunk-4D7AL5UB.js";function F(r,h){if(r&1){let t=_();n(0,"div",1)(1,"div",2)(2,"div",3),o(3,"\u23F0"),i(),n(4,"h2"),o(5,"Session Expiring Soon"),i(),n(6,"p"),o(7,"Your session will expire in:"),i(),n(8,"div",4),o(9),i(),n(10,"p",5),o(11,"You will be automatically logged out for security reasons."),i(),n(12,"div",6)(13,"button",7),f("click",function(){g(t);let a=l();return p(a.extendSession())}),o(14,"Stay Logged In"),i(),n(15,"button",8),f("click",function(){g(t);let a=l();return p(a.logout())}),o(16,"Logout Now"),i()()()()}if(r&2){let t=l();s(9),m(t.remainingTime)}}var L=(()=>{class r{constructor(t){this.router=t,this.showWarning=!1,this.remainingTime="",this.warningTime=5*60*1e3,this.sessionDuration=30*60*1e3,this.lastActivityTime=Date.now()}ngOnInit(){this.startActivityTracking(),this.startSessionCheck()}ngOnDestroy(){this.checkInterval?.unsubscribe(),this.countdownInterval?.unsubscribe()}startActivityTracking(){["mousedown","keydown","scroll","touchstart"].forEach(t=>{document.addEventListener(t,()=>this.updateActivity(),!0)})}updateActivity(){this.showWarning||(this.lastActivityTime=Date.now())}startSessionCheck(){this.checkInterval=w(1e3).subscribe(()=>{let t=Date.now()-this.lastActivityTime,e=this.sessionDuration-t;e<=0?this.forceLogout():e<=this.warningTime&&!this.showWarning&&(this.showWarning=!0,this.startCountdown())})}startCountdown(){this.countdownInterval=w(1e3).subscribe(()=>{let t=Date.now()-this.lastActivityTime,e=this.sessionDuration-t;if(e<=0)this.forceLogout();else{let a=Math.floor(e/6e4),U=Math.floor(e%6e4/1e3);this.remainingTime=`${a}:${U.toString().padStart(2,"0")}`}})}extendSession(){this.lastActivityTime=Date.now(),this.showWarning=!1,this.countdownInterval?.unsubscribe()}logout(){this.forceLogout()}forceLogout(){this.checkInterval?.unsubscribe(),this.countdownInterval?.unsubscribe(),localStorage.clear(),sessionStorage.clear(),this.router.navigate(["/auth/login"],{queryParams:{reason:"session-expired"}})}static{this.\u0275fac=function(e){return new(e||r)(d(M))}}static{this.\u0275cmp=v({type:r,selectors:[["app-session-timeout"]],standalone:!0,features:[b],decls:1,vars:1,consts:[["class","session-warning-overlay",4,"ngIf"],[1,"session-warning-overlay"],[1,"session-warning-modal"],[1,"warning-icon"],[1,"countdown"],[1,"hint"],[1,"actions"],[1,"btn-primary",3,"click"],[1,"btn-secondary",3,"click"]],template:function(e,a){e&1&&u(0,F,17,1,"div",0),e&2&&c("ngIf",a.showWarning)},dependencies:[C,y],styles:[".session-warning-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#000000b3;display:flex;align-items:center;justify-content:center;z-index:10000;animation:_ngcontent-%COMP%_fadeIn .3s}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.session-warning-modal[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:2rem;max-width:400px;width:90%;text-align:center;box-shadow:0 20px 60px #0000004d;animation:_ngcontent-%COMP%_slideUp .3s}@keyframes _ngcontent-%COMP%_slideUp{0%{transform:translateY(20px);opacity:0}to{transform:translateY(0);opacity:1}}.warning-icon[_ngcontent-%COMP%]{font-size:4rem;margin-bottom:1rem;animation:_ngcontent-%COMP%_pulse 1.5s infinite}@keyframes _ngcontent-%COMP%_pulse{0%,to{transform:scale(1)}50%{transform:scale(1.1)}}h2[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:#0f172a;margin-bottom:.5rem}p[_ngcontent-%COMP%]{color:#64748b;margin-bottom:1rem}.countdown[_ngcontent-%COMP%]{font-size:3rem;font-weight:700;color:#ef4444;font-family:monospace;margin:1rem 0}.hint[_ngcontent-%COMP%]{font-size:.875rem;margin-bottom:1.5rem}.actions[_ngcontent-%COMP%]{display:flex;gap:1rem}.btn-primary[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%]{flex:1;padding:12px;border:none;border-radius:8px;font-weight:600;cursor:pointer;transition:all .2s}.btn-primary[_ngcontent-%COMP%]{background:#06f;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{background:#0052cc}.btn-secondary[_ngcontent-%COMP%]{background:#fff;color:#64748b;border:1px solid #e2e8f0}.btn-secondary[_ngcontent-%COMP%]:hover{background:#f8fafc}@media (max-width: 480px){.session-warning-modal[_ngcontent-%COMP%]{padding:1.5rem}.warning-icon[_ngcontent-%COMP%]{font-size:3rem}.countdown[_ngcontent-%COMP%]{font-size:2rem}.actions[_ngcontent-%COMP%]{flex-direction:column}}"]})}}return r})();function $(r,h){r&1&&(n(0,"div",21),o(1,"Acme Recruiting"),i())}function j(r,h){if(r&1&&(n(0,"a",22)(1,"span",10),o(2),i(),n(3,"span"),o(4),i()()),r&2){let t=h.$implicit;c("routerLink",t.route),s(2),m(t.icon),s(2),m(t.label)}}function V(r,h){if(r&1){let t=_();n(0,"div",1),x(1,"app-session-timeout"),n(2,"aside",2)(3,"div",3)(4,"div",4),o(5,"\u26A1 TalentForge"),i(),u(6,$,2,0,"div",5),i(),n(7,"nav",6),u(8,j,5,3,"a",7),i(),n(9,"div",8)(10,"a",9)(11,"span",10),o(12,"\u2699\uFE0F"),i(),n(13,"span"),o(14,"Settings"),i()(),n(15,"a",11),f("click",function(){g(t);let a=l();return p(a.logout())}),n(16,"span",10),o(17,"\u{1F6AA}"),i(),n(18,"span"),o(19,"Logout"),i()()()(),n(20,"main",12)(21,"header",13)(22,"div",14)(23,"span",10),o(24,"\u{1F50D}"),i(),x(25,"input",15),i(),n(26,"div",16)(27,"button",17),o(28,"\u{1F514}"),i(),n(29,"div",18)(30,"div",19),o(31),i(),n(32,"span"),o(33),i()()()(),n(34,"div",20),x(35,"router-outlet"),i()()()}if(r&2){let t=l();s(6),c("ngIf",t.showTenantName),s(2),c("ngForOf",t.navigationItems),s(17),c("placeholder",t.searchPlaceholder),s(6),m(t.userInitials),s(2),m(t.userName)}}var X=(()=>{class r{constructor(t,e,a){this.router=t,this.authService=e,this.navigationService=a,this.currentUser=null,this.navigationItems=[],this.destroy$=new S}ngOnInit(){let t=this.authService.getCurrentUserValue();t&&(this.currentUser=t,this.navigationItems=this.navigationService.getNavigationForRole(t.role)),this.authService.currentUser$.pipe(O(this.destroy$)).subscribe(e=>{this.currentUser=e,e?this.navigationItems=this.navigationService.getNavigationForRole(e.role):this.navigationItems=[]})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}get userName(){return this.currentUser?`${this.currentUser.firstName} ${this.currentUser.lastName}`:"User"}get userInitials(){return this.currentUser?`${this.currentUser.firstName[0]}${this.currentUser.lastName[0]}`:"U"}get showTenantName(){return this.currentUser?this.navigationService.isTenantRole(this.currentUser.role):!1}get searchPlaceholder(){if(!this.currentUser)return"Search...";switch(this.currentUser.role){case"CANDIDATE":return"Search jobs or companies...";case"RECRUITER":return"Search candidates, jobs, or companies...";case"TENANT_ADMIN":return"Search team, jobs, or candidates...";case"PLATFORM_ADMIN":case"PLATFORM_SUPER_ADMIN":return"Search tenants...";case"BILLING_MANAGER":return"Search subscriptions or invoices...";default:return"Search..."}}logout(){this.authService.logout()}static{this.\u0275fac=function(e){return new(e||r)(d(M),d(D),d(A))}}static{this.\u0275cmp=v({type:r,selectors:[["app-main-layout"]],standalone:!0,features:[b],decls:1,vars:1,consts:[["class","layout",4,"ngIf"],[1,"layout"],[1,"sidebar"],[1,"logo-section"],[1,"logo"],["class","tenant-name",4,"ngIf"],[1,"nav-menu"],["class","nav-item","routerLinkActive","active",3,"routerLink",4,"ngFor","ngForOf"],[1,"sidebar-footer"],["routerLink","/settings","routerLinkActive","active",1,"nav-item"],[1,"icon"],[1,"nav-item",3,"click"],[1,"main-content"],[1,"top-bar"],[1,"search-bar"],["type","text",3,"placeholder"],[1,"top-actions"],[1,"icon-btn"],[1,"user-profile"],[1,"avatar"],[1,"content"],[1,"tenant-name"],["routerLinkActive","active",1,"nav-item",3,"routerLink"]],template:function(e,a){e&1&&u(0,V,36,5,"div",0),e&2&&c("ngIf",a.currentUser)},dependencies:[C,P,y,E,k,I,T,L],styles:[".layout[_ngcontent-%COMP%]{display:flex;min-height:100vh;background:#f8fafc;font-family:Inter,sans-serif}.sidebar[_ngcontent-%COMP%]{width:260px;background:#0f172a;color:#fff;display:flex;flex-direction:column;position:fixed;height:100vh;left:0;top:0;z-index:1000}.logo-section[_ngcontent-%COMP%]{padding:24px;border-bottom:1px solid rgba(255,255,255,.1)}.logo[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;background:linear-gradient(135deg,#06f,#00d4ff);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;margin-bottom:8px}.tenant-name[_ngcontent-%COMP%]{font-size:.75rem;color:#64748b;font-weight:500}.nav-menu[_ngcontent-%COMP%]{flex:1;padding:16px;overflow-y:auto}.nav-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px 16px;color:#94a3b8;text-decoration:none;border-radius:8px;margin-bottom:4px;transition:all .3s;cursor:pointer}.nav-item[_ngcontent-%COMP%]:hover{background:#ffffff1a;color:#fff}.nav-item.active[_ngcontent-%COMP%]{background:#06f;color:#fff}.nav-item[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{font-size:1.25rem}.sidebar-footer[_ngcontent-%COMP%]{padding:16px;border-top:1px solid rgba(255,255,255,.1)}.main-content[_ngcontent-%COMP%]{flex:1;margin-left:260px;display:flex;flex-direction:column;min-height:100vh}.top-bar[_ngcontent-%COMP%]{background:#fff;padding:16px 32px;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #e2e8f0;position:sticky;top:0;z-index:100}.search-bar[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;background:#f8fafc;padding:10px 16px;border-radius:8px;width:400px}.search-bar[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{font-size:1.25rem}.search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;background:transparent;outline:none;width:100%;font-size:.875rem}.top-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px}.icon-btn[_ngcontent-%COMP%]{background:#f8fafc;border:none;width:40px;height:40px;border-radius:8px;cursor:pointer;font-size:1.25rem;transition:all .3s}.icon-btn[_ngcontent-%COMP%]:hover{background:#e2e8f0}.user-profile[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;cursor:pointer}.avatar[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;background:linear-gradient(135deg,#06f,#00d4ff);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:600;font-size:.875rem}.content[_ngcontent-%COMP%]{flex:1}"]})}}return r})();export{X as a};
