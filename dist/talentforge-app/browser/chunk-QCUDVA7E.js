import{a as $}from"./chunk-BGS7KIU3.js";import"./chunk-BMJOLE36.js";import{a as D}from"./chunk-MX3KJ2PE.js";import"./chunk-TGBIRMAY.js";import{b as z,c as N,e as g,f as R,g as V,i as q,j,k as G,p as H,r as J}from"./chunk-YXQLQ2ZV.js";import{g as I,h as A,k as F}from"./chunk-AHQOJUUW.js";import"./chunk-WIHTSVPG.js";import{$b as o,Ab as f,Bb as s,Cb as b,Da as x,E as M,Ea as _,Jb as n,Kb as i,Lb as h,M as P,Nb as O,Pc as L,Qb as w,Sb as m,Tc as T,ac as v,bc as C,d as S,gb as a,hb as u,ic as E,ua as y,zb as p}from"./chunk-EGDJTDOV.js";function Z(t,c){if(t&1&&(n(0,"div",8)(1,"div",9),o(2,"\u{1F512}"),i(),n(3,"h3",10),o(4,"Account Temporarily Locked"),i(),n(5,"p"),o(6,"Too many failed login attempts."),i(),n(7,"div",11)(8,"span",12),o(9),i(),n(10,"span",13),o(11,"remaining"),i()(),n(12,"p",14),o(13,"Try again after the timer expires or "),n(14,"a",15),o(15,"reset your password"),i()()()),t&2){let e=m();a(9),v(e.remainingLockoutTime)}}function B(t,c){if(t&1&&(n(0,"span"),o(1),i()),t&2){let e=m(2);a(),C(" Invalid credentials. ",e.remainingAttempts," attempts remaining before account lockout. ")}}function W(t,c){t&1&&(n(0,"span",20),o(1," Last attempt! Account will be locked for 15 minutes after next failed login. "),i())}function Y(t,c){if(t&1&&(n(0,"div",16)(1,"span",17),o(2,"\u26A0\uFE0F"),i(),n(3,"div"),p(4,B,2,1,"span",18)(5,W,2,0,"span",19),i()()),t&2){let e=m();a(4),s("ngIf",e.remainingAttempts>1),a(),s("ngIf",e.remainingAttempts===1)}}function K(t,c){t&1&&(n(0,"div",21)(1,"span",22),o(2,"\u{1F6E1}\uFE0F"),i(),n(3,"div")(4,"strong"),o(5,"Security verification enabled"),i(),n(6,"p"),o(7,"Your login attempts are being verified by reCAPTCHA to protect your account."),i()()())}function Q(t,c){if(t&1&&(n(0,"div",23),o(1),i()),t&2){let e=m();a(),C(" ",e.errorMessage," ")}}function U(t,c){t&1&&(n(0,"span",43),o(1,"Email is required"),i())}function X(t,c){t&1&&(n(0,"span",43),o(1,"Please enter a valid email"),i())}function ee(t,c){if(t&1&&(n(0,"div",41),p(1,U,2,0,"span",42)(2,X,2,0,"span",42),i()),t&2){let e=m(2);a(),s("ngIf",e.email==null||e.email.errors==null?null:e.email.errors.required),a(),s("ngIf",e.email==null||e.email.errors==null?null:e.email.errors.email)}}function te(t,c){t&1&&(n(0,"span",45),o(1,"Password is required"),i())}function ne(t,c){t&1&&(n(0,"span",45),o(1,"Password must be at least 6 characters"),i())}function ie(t,c){if(t&1&&(n(0,"div",41),p(1,te,2,0,"span",44)(2,ne,2,0,"span",44),i()),t&2){let e=m(2);a(),s("ngIf",e.password==null||e.password.errors==null?null:e.password.errors.required),a(),s("ngIf",e.password==null||e.password.errors==null?null:e.password.errors.minlength)}}function oe(t,c){t&1&&(n(0,"span"),o(1,"Sign In"),i())}function re(t,c){t&1&&(n(0,"span"),o(1,"Signing in..."),i())}function ae(t,c){if(t&1){let e=O();n(0,"form",24),w("ngSubmit",function(){x(e);let r=m();return _(r.onSubmit())}),n(1,"div",25)(2,"label",26),o(3,"Email Address"),i(),h(4,"input",27),p(5,ee,3,2,"div",28),i(),n(6,"div",25)(7,"label",29),o(8,"Password"),i(),n(9,"div",30),h(10,"input",31),n(11,"button",32),w("click",function(){x(e);let r=m();return _(r.hidePassword=!r.hidePassword)}),n(12,"span",33),o(13),i()()(),p(14,ie,3,2,"div",28),i(),n(15,"div",34)(16,"label",35),h(17,"input",36),n(18,"span"),o(19,"Remember me"),i()(),n(20,"a",37),o(21,"Forgot password?"),i()(),n(22,"button",38),p(23,oe,2,0,"span",18)(24,re,2,0,"span",18),i(),n(25,"div",39)(26,"span"),o(27,"Don't have an account? "),i(),n(28,"a",40),o(29,"Create one here"),i()()()}if(t&2){let e=m();s("formGroup",e.loginForm),a(4),b("error",(e.email==null?null:e.email.invalid)&&(e.email==null?null:e.email.touched)),f("aria-invalid",(e.email==null?null:e.email.invalid)&&(e.email==null?null:e.email.touched))("aria-describedby",e.email!=null&&e.email.invalid&&(e.email!=null&&e.email.touched)?"email-error":null),a(),s("ngIf",(e.email==null?null:e.email.invalid)&&(e.email==null?null:e.email.touched)),a(5),b("error",(e.password==null?null:e.password.invalid)&&(e.password==null?null:e.password.touched)),s("type",e.hidePassword?"password":"text"),f("aria-invalid",(e.password==null?null:e.password.invalid)&&(e.password==null?null:e.password.touched))("aria-describedby",e.password!=null&&e.password.invalid&&(e.password!=null&&e.password.touched)?"password-error":null),a(),f("aria-label",e.hidePassword?"Show password":"Hide password"),a(2),v(e.hidePassword?"\u{1F441}\uFE0F":"\u{1F648}"),a(),s("ngIf",(e.password==null?null:e.password.invalid)&&(e.password==null?null:e.password.touched)),a(8),s("disabled",e.loginForm.invalid||e.loading),a(),s("ngIf",!e.loading),a(),s("ngIf",e.loading)}}var be=(()=>{class t{constructor(e,l,r,d){this.fb=e,this.authFacade=l,this.router=r,this.navigationService=d,this.loading=!1,this.errorMessage="",this.hidePassword=!0,this.failedAttempts=0,this.maxAttempts=5,this.captchaThreshold=3,this.isLocked=!1,this.showCaptcha=!1,this.lockoutEndTime=null,this.remainingLockoutTime="",this.loginForm=this.fb.group({email:["",[g.required,g.email]],password:["",[g.required,g.minLength(6)]],rememberMe:[!1]})}ngOnInit(){this.checkExistingLockout(),this.loadRecaptchaScript()}ngOnDestroy(){this.lockoutSubscription?.unsubscribe()}get email(){return this.loginForm.get("email")}get password(){return this.loginForm.get("password")}get remainingAttempts(){return Math.max(0,this.maxAttempts-this.failedAttempts)}get showAttemptsWarning(){return this.failedAttempts>0&&!this.isLocked&&!this.showCaptcha}checkExistingLockout(){let e=localStorage.getItem("loginLockout");if(e){let{endTime:l,attempts:r}=JSON.parse(e);this.failedAttempts=r||0,l&&l>Date.now()?(this.lockoutEndTime=new Date(l),this.isLocked=!0,this.startLockoutTimer()):this.clearLockout(),this.failedAttempts>=this.captchaThreshold&&(this.showCaptcha=!0)}}startLockoutTimer(){this.updateLockoutTime(),this.lockoutSubscription=M(1e3).subscribe(()=>{this.updateLockoutTime()})}updateLockoutTime(){if(this.lockoutEndTime){let e=Date.now(),l=this.lockoutEndTime.getTime()-e;if(l<=0)this.clearLockout();else{let r=Math.floor(l/6e4),d=Math.floor(l%6e4/1e3);this.remainingLockoutTime=`${r}:${d.toString().padStart(2,"0")}`}}}clearLockout(){this.isLocked=!1,this.failedAttempts=0,this.showCaptcha=!1,this.lockoutEndTime=null,this.remainingLockoutTime="",localStorage.removeItem("loginLockout"),this.lockoutSubscription?.unsubscribe()}handleFailedLogin(){this.failedAttempts++,this.failedAttempts>=this.captchaThreshold&&(this.showCaptcha=!0),this.failedAttempts>=this.maxAttempts?this.lockAccount():localStorage.setItem("loginLockout",JSON.stringify({attempts:this.failedAttempts,endTime:new Date().getTime()}))}lockAccount(){this.isLocked=!0;let e=15*60*1e3;this.lockoutEndTime=new Date(Date.now()+e),localStorage.setItem("loginLockout",JSON.stringify({endTime:this.lockoutEndTime.getTime(),attempts:this.failedAttempts})),this.startLockoutTimer()}onSubmit(){return S(this,null,function*(){if(this.loginForm.valid&&!this.isLocked){if(this.loading=!0,this.errorMessage="",this.showCaptcha)try{let r=yield this.executeRecaptcha();console.log("reCAPTCHA token:",r)}catch{this.errorMessage="reCAPTCHA verification failed. Please try again.",this.loading=!1;return}this.authFacade.login(this.loginForm.value);let e=this.authFacade.isAuthenticated$.subscribe(r=>{r&&(this.authFacade.user$.pipe(P(1)).subscribe(d=>{if(d){this.loading=!1,this.clearLockout(),this.loginForm.get("rememberMe")?.value?(localStorage.setItem("rememberMe","true"),localStorage.setItem("rememberMeExpiry",(Date.now()+30*24*60*60*1e3).toString())):(localStorage.removeItem("rememberMe"),localStorage.removeItem("rememberMeExpiry"));let k=this.navigationService.getDashboardRoute(d.role);console.log("Redirecting to:",k,"for user:",d.email,"role:",d.role),this.router.navigate([k])}}),e.unsubscribe())}),l=this.authFacade.error$.subscribe(r=>{r&&(this.loading=!1,this.errorMessage=r,this.handleFailedLogin(),l.unsubscribe())})}})}loadRecaptchaScript(){if(document.getElementById("recaptcha-script"))return;let e=document.createElement("script");e.id="recaptcha-script",e.src="https://www.google.com/recaptcha/api.js?render=6LeIxAcTAAAAAJcZVRqyHh71UMIEGNQ_MXjiZKhI",e.async=!0,e.defer=!0,document.head.appendChild(e)}executeRecaptcha(){return new Promise((e,l)=>{let r=()=>{window.grecaptcha&&window.grecaptcha.ready?window.grecaptcha.ready(()=>{window.grecaptcha.execute("6LeIxAcTAAAAAJcZVRqyHh71UMIEGNQ_MXjiZKhI",{action:"login"}).then(d=>e(d)).catch(d=>l(d))}):setTimeout(r,100)};r()})}static{this.\u0275fac=function(l){return new(l||t)(u(H),u($),u(I),u(D))}}static{this.\u0275cmp=y({type:t,selectors:[["app-login-standalone"]],standalone:!0,features:[E],decls:12,vars:5,consts:[[1,"auth-container"],[1,"auth-card"],[1,"auth-header"],["class","lockout-warning","role","alert","aria-live","assertive",4,"ngIf"],["class","attempts-warning","role","alert","aria-live","polite",4,"ngIf"],["class","captcha-notice","role","status","aria-live","polite",4,"ngIf"],["class","error-message","role","alert","aria-live","assertive",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],["role","alert","aria-live","assertive",1,"lockout-warning"],["aria-hidden","true",1,"lockout-icon"],["id","lockout-heading"],[1,"countdown"],[1,"time"],[1,"label"],[1,"hint"],["routerLink","/auth/forgot-password"],["role","alert","aria-live","polite",1,"attempts-warning"],["aria-hidden","true",1,"warning-icon"],[4,"ngIf"],["class","final-warning",4,"ngIf"],[1,"final-warning"],["role","status","aria-live","polite",1,"captcha-notice"],["aria-hidden","true",1,"shield-icon"],["role","alert","aria-live","assertive",1,"error-message"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","email"],["id","email","type","email","formControlName","email","placeholder","Enter your email","autocomplete","email","aria-required","true",1,"form-control"],["class","error-text","role","alert",4,"ngIf"],["for","password"],[1,"password-wrapper"],["id","password","formControlName","password","placeholder","Enter your password","autocomplete","current-password","aria-required","true",1,"form-control",3,"type"],["type","button",1,"toggle-password",3,"click"],["aria-hidden","true"],[1,"form-options"],[1,"checkbox-label"],["type","checkbox","formControlName","rememberMe"],["routerLink","/auth/forgot-password",1,"link"],["type","submit",1,"btn-primary",3,"disabled"],[1,"auth-footer"],["routerLink","/auth/register",1,"link"],["role","alert",1,"error-text"],["id","email-error",4,"ngIf"],["id","email-error"],["id","password-error",4,"ngIf"],["id","password-error"]],template:function(l,r){l&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),o(4,"Welcome Back"),i(),n(5,"p"),o(6,"Sign in to your TalentForge account"),i()(),p(7,Z,16,1,"div",3)(8,Y,6,2,"div",4)(9,K,8,0,"div",5)(10,Q,2,1,"div",6)(11,ae,30,17,"form",7),i()()),l&2&&(a(7),s("ngIf",r.isLocked),a(),s("ngIf",r.showAttemptsWarning&&!r.isLocked),a(),s("ngIf",r.showCaptcha&&!r.isLocked),a(),s("ngIf",r.errorMessage),a(),s("ngIf",!r.isLocked))},dependencies:[T,L,J,q,N,z,R,V,j,G,F,A],styles:['.auth-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#06f,#00d4ff);padding:2rem;position:relative;overflow:hidden}.auth-container[_ngcontent-%COMP%]:before{content:"";position:absolute;top:-50%;right:-50%;width:100%;height:100%;background:radial-gradient(circle,rgba(255,255,255,.1) 0%,transparent 70%)}.auth-container[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:-50%;left:-50%;width:100%;height:100%;background:radial-gradient(circle,rgba(255,255,255,.05) 0%,transparent 70%)}.auth-card[_ngcontent-%COMP%]{background:#fffffff2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:16px;box-shadow:0 20px 60px #0000004d;padding:3rem;max-width:450px;width:100%;position:relative;z-index:1;border:1px solid rgba(255,255,255,.2)}.auth-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:2.5rem}.auth-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;color:#1e293b;margin:0 0 .75rem;background:linear-gradient(135deg,#06f,#00d4ff);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.auth-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#64748b;font-size:.9375rem;margin:0}.form-group[_ngcontent-%COMP%]{margin-bottom:1.5rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:.875rem;font-weight:500;color:#475569;margin-bottom:.5rem}.form-control[_ngcontent-%COMP%]{width:100%;padding:12px 16px;border:1px solid #e2e8f0;border-radius:8px;font-size:.875rem;transition:all .2s;box-sizing:border-box}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#06f;box-shadow:0 0 0 3px #0066ff26}.form-control.error[_ngcontent-%COMP%]{border-color:#ef4444}.password-wrapper[_ngcontent-%COMP%]{position:relative}.password-wrapper[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{padding-right:45px}.toggle-password[_ngcontent-%COMP%]{position:absolute;right:12px;top:50%;transform:translateY(-50%);background:none;border:none;cursor:pointer;font-size:1.25rem;padding:0;line-height:1}.error-text[_ngcontent-%COMP%]{color:#ef4444;font-size:.75rem;margin-top:.5rem}.form-options[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-size:.875rem;color:#475569;cursor:pointer}.btn-primary[_ngcontent-%COMP%]{width:100%;padding:14px;border:none;border-radius:8px;font-weight:600;cursor:pointer;transition:all .3s;background:linear-gradient(135deg,#06f,#00d4ff);color:#fff;margin-bottom:1rem;font-size:.9375rem;box-shadow:0 4px 15px #06f6}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 6px 20px #06f9}.btn-primary[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed;transform:none}.auth-footer[_ngcontent-%COMP%]{text-align:center;font-size:.875rem;color:#64748b}.link[_ngcontent-%COMP%]{color:#06f;text-decoration:none;font-size:.875rem;font-weight:500;transition:all .2s}.link[_ngcontent-%COMP%]:hover{color:#0052cc;text-decoration:underline}.error-message[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b;padding:12px;border-radius:8px;margin-bottom:1.5rem;font-size:.875rem}.lockout-warning[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fee2e2,#fecaca);border:2px solid #ef4444;border-radius:12px;padding:24px;text-align:center;margin-bottom:1.5rem}.lockout-icon[_ngcontent-%COMP%]{font-size:3rem;margin-bottom:12px}.lockout-warning[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#991b1b;font-size:1.25rem;font-weight:600;margin:0 0 8px}.lockout-warning[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#7f1d1d;margin:0 0 16px;font-size:.875rem}.countdown[_ngcontent-%COMP%]{background:#fff;border-radius:8px;padding:16px;margin-bottom:16px}.countdown[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{display:block;font-size:2rem;font-weight:700;color:#dc2626;font-family:monospace}.countdown[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{display:block;font-size:.75rem;color:#7f1d1d;text-transform:uppercase;letter-spacing:1px;margin-top:4px}.lockout-warning[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]{font-size:.8125rem;color:#7f1d1d}.lockout-warning[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#dc2626;font-weight:600;text-decoration:none}.lockout-warning[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.attempts-warning[_ngcontent-%COMP%]{background:#fef3c7;border-left:4px solid #f59e0b;padding:12px 16px;border-radius:8px;margin-bottom:1.5rem;display:flex;align-items:flex-start;gap:12px;font-size:.875rem;color:#92400e;line-height:1.5}.warning-icon[_ngcontent-%COMP%]{font-size:1.25rem;flex-shrink:0}.final-warning[_ngcontent-%COMP%]{font-weight:600;color:#dc2626}.captcha-notice[_ngcontent-%COMP%]{background:#dbeafe;border-left:4px solid #0066ff;padding:12px 16px;border-radius:8px;margin-bottom:1.5rem;display:flex;align-items:flex-start;gap:12px;font-size:.875rem;color:#1e40af;line-height:1.5}.shield-icon[_ngcontent-%COMP%]{font-size:1.25rem;flex-shrink:0}.captcha-notice[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{display:block;margin-bottom:4px}.captcha-notice[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.8125rem;color:#1e3a8a}@media (max-width: 768px){.auth-container[_ngcontent-%COMP%]{padding:1rem}.auth-card[_ngcontent-%COMP%]{padding:2rem 1.5rem}.auth-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.5rem}.lockout-icon[_ngcontent-%COMP%]{font-size:2.5rem}.countdown[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{font-size:1.5rem}}']})}}return t})();export{be as LoginStandaloneComponent};
