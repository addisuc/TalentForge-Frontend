import{a as $}from"./chunk-E5ZNVKB7.js";import"./chunk-I6CG5S7U.js";import{a as A}from"./chunk-O5ZM3L5J.js";import"./chunk-TGBIRMAY.js";import{b as F,c as D,e as u,f as z,g as N,i as V,j as R,k as j,o as q,q as G}from"./chunk-NSYUTGZ4.js";import{g as E,h as T,k as I}from"./chunk-UY2YNJ4I.js";import"./chunk-5W2ODH74.js";import{Ab as b,Ca as _,D as k,Da as x,Hb as n,Ib as o,Jb as f,L as v,Lb as M,Lc as L,Ob as w,Oc as y,Qb as m,Yb as i,Zb as P,_b as h,eb as r,fb as g,fc as O,ta as S,xb as p,zb as l}from"./chunk-4D7AL5UB.js";function J(e,c){if(e&1&&(n(0,"div",7)(1,"div",8),i(2,"\u{1F512}"),o(),n(3,"h3"),i(4,"Account Temporarily Locked"),o(),n(5,"p"),i(6,"Too many failed login attempts."),o(),n(7,"div",9)(8,"span",10),i(9),o(),n(10,"span",11),i(11,"remaining"),o()(),n(12,"p",12),i(13,"Try again after the timer expires or "),n(14,"a",13),i(15,"reset your password"),o()()()),e&2){let t=m();r(9),P(t.remainingLockoutTime)}}function W(e,c){if(e&1&&(n(0,"span"),i(1),o()),e&2){let t=m(2);r(),h(" Invalid credentials. ",t.remainingAttempts," attempts remaining before account lockout. ")}}function B(e,c){e&1&&(n(0,"span",18),i(1," Last attempt! Account will be locked for 15 minutes after next failed login. "),o())}function Y(e,c){if(e&1&&(n(0,"div",14)(1,"span",15),i(2,"\u26A0\uFE0F"),o(),n(3,"div"),p(4,W,2,1,"span",16)(5,B,2,0,"span",17),o()()),e&2){let t=m();r(4),l("ngIf",t.remainingAttempts>1),r(),l("ngIf",t.remainingAttempts===1)}}function H(e,c){if(e&1&&(n(0,"div",19),i(1),o()),e&2){let t=m();r(),h(" ",t.errorMessage," ")}}function K(e,c){e&1&&(n(0,"span"),i(1,"Email is required"),o())}function Q(e,c){e&1&&(n(0,"span"),i(1,"Please enter a valid email"),o())}function U(e,c){if(e&1&&(n(0,"div",36),p(1,K,2,0,"span",16)(2,Q,2,0,"span",16),o()),e&2){let t=m(2);r(),l("ngIf",t.email==null||t.email.errors==null?null:t.email.errors.required),r(),l("ngIf",t.email==null||t.email.errors==null?null:t.email.errors.email)}}function X(e,c){e&1&&(n(0,"span"),i(1,"Password is required"),o())}function Z(e,c){e&1&&(n(0,"span"),i(1,"Password must be at least 6 characters"),o())}function tt(e,c){if(e&1&&(n(0,"div",36),p(1,X,2,0,"span",16)(2,Z,2,0,"span",16),o()),e&2){let t=m(2);r(),l("ngIf",t.password==null||t.password.errors==null?null:t.password.errors.required),r(),l("ngIf",t.password==null||t.password.errors==null?null:t.password.errors.minlength)}}function et(e,c){e&1&&(n(0,"span"),i(1,"Sign In"),o())}function nt(e,c){e&1&&(n(0,"span"),i(1,"Signing in..."),o())}function ot(e,c){if(e&1){let t=M();n(0,"form",20),w("ngSubmit",function(){_(t);let a=m();return x(a.onSubmit())}),n(1,"div",21)(2,"label",22),i(3,"Email Address"),o(),f(4,"input",23),p(5,U,3,2,"div",24),o(),n(6,"div",21)(7,"label",25),i(8,"Password"),o(),n(9,"div",26),f(10,"input",27),n(11,"button",28),w("click",function(){_(t);let a=m();return x(a.hidePassword=!a.hidePassword)}),i(12),o()(),p(13,tt,3,2,"div",24),o(),n(14,"div",29)(15,"label",30),f(16,"input",31),n(17,"span"),i(18,"Remember me"),o()(),n(19,"a",32),i(20,"Forgot password?"),o()(),n(21,"button",33),p(22,et,2,0,"span",16)(23,nt,2,0,"span",16),o(),n(24,"div",34)(25,"span"),i(26,"Don't have an account? "),o(),n(27,"a",35),i(28,"Create one here"),o()()()}if(e&2){let t=m();l("formGroup",t.loginForm),r(4),b("error",(t.email==null?null:t.email.invalid)&&(t.email==null?null:t.email.touched)),r(),l("ngIf",(t.email==null?null:t.email.invalid)&&(t.email==null?null:t.email.touched)),r(5),b("error",(t.password==null?null:t.password.invalid)&&(t.password==null?null:t.password.touched)),l("type",t.hidePassword?"password":"text"),r(2),h(" ",t.hidePassword?"\u{1F441}\uFE0F":"\u{1F648}"," "),r(),l("ngIf",(t.password==null?null:t.password.invalid)&&(t.password==null?null:t.password.touched)),r(8),l("disabled",t.loginForm.invalid||t.loading),r(),l("ngIf",!t.loading),r(),l("ngIf",t.loading)}}var ft=(()=>{class e{constructor(t,s,a,d){this.fb=t,this.authFacade=s,this.router=a,this.navigationService=d,this.loading=!1,this.errorMessage="",this.hidePassword=!0,this.failedAttempts=0,this.maxAttempts=5,this.isLocked=!1,this.lockoutEndTime=null,this.remainingLockoutTime="",this.loginForm=this.fb.group({email:["",[u.required,u.email]],password:["",[u.required,u.minLength(6)]],rememberMe:[!1]})}ngOnInit(){this.checkExistingLockout()}ngOnDestroy(){this.lockoutSubscription?.unsubscribe()}get email(){return this.loginForm.get("email")}get password(){return this.loginForm.get("password")}get remainingAttempts(){return Math.max(0,this.maxAttempts-this.failedAttempts)}get showAttemptsWarning(){return this.failedAttempts>0&&!this.isLocked}checkExistingLockout(){let t=localStorage.getItem("loginLockout");if(t){let{endTime:s,attempts:a}=JSON.parse(t);this.lockoutEndTime=new Date(s),this.failedAttempts=a,this.lockoutEndTime>new Date?(this.isLocked=!0,this.startLockoutTimer()):this.clearLockout()}}startLockoutTimer(){this.lockoutSubscription=k(1e3).subscribe(()=>{if(this.lockoutEndTime){let t=new Date,s=this.lockoutEndTime.getTime()-t.getTime();if(s<=0)this.clearLockout();else{let a=Math.floor(s/6e4),d=Math.floor(s%6e4/1e3);this.remainingLockoutTime=`${a}:${d.toString().padStart(2,"0")}`}}})}clearLockout(){this.isLocked=!1,this.failedAttempts=0,this.lockoutEndTime=null,this.remainingLockoutTime="",localStorage.removeItem("loginLockout"),this.lockoutSubscription?.unsubscribe()}handleFailedLogin(){this.failedAttempts++,this.failedAttempts>=this.maxAttempts?this.lockAccount():localStorage.setItem("loginLockout",JSON.stringify({attempts:this.failedAttempts,endTime:new Date().getTime()}))}lockAccount(){this.isLocked=!0;let t=15*60*1e3;this.lockoutEndTime=new Date(Date.now()+t),localStorage.setItem("loginLockout",JSON.stringify({endTime:this.lockoutEndTime.getTime(),attempts:this.failedAttempts})),this.startLockoutTimer()}onSubmit(){if(this.loginForm.valid&&!this.isLocked){this.loading=!0,this.errorMessage="",this.authFacade.login(this.loginForm.value);let t=this.authFacade.isAuthenticated$.subscribe(a=>{a&&(this.authFacade.user$.pipe(v(1)).subscribe(d=>{if(d){this.loading=!1,this.clearLockout();let C=this.navigationService.getDashboardRoute(d.role);console.log("Redirecting to:",C,"for user:",d.email,"role:",d.role),this.router.navigate([C])}}),t.unsubscribe())}),s=this.authFacade.error$.subscribe(a=>{a&&(this.loading=!1,this.errorMessage=a,this.handleFailedLogin(),s.unsubscribe())})}}static{this.\u0275fac=function(s){return new(s||e)(g(q),g($),g(E),g(A))}}static{this.\u0275cmp=S({type:e,selectors:[["app-login-standalone"]],standalone:!0,features:[O],decls:11,vars:4,consts:[[1,"auth-container"],[1,"auth-card"],[1,"auth-header"],["class","lockout-warning",4,"ngIf"],["class","attempts-warning",4,"ngIf"],["class","error-message",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"lockout-warning"],[1,"lockout-icon"],[1,"countdown"],[1,"time"],[1,"label"],[1,"hint"],["routerLink","/auth/forgot-password"],[1,"attempts-warning"],[1,"warning-icon"],[4,"ngIf"],["class","final-warning",4,"ngIf"],[1,"final-warning"],[1,"error-message"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","email"],["id","email","type","email","formControlName","email","placeholder","Enter your email","autocomplete","email",1,"form-control"],["class","error-text",4,"ngIf"],["for","password"],[1,"password-wrapper"],["id","password","formControlName","password","placeholder","Enter your password","autocomplete","current-password",1,"form-control",3,"type"],["type","button",1,"toggle-password",3,"click"],[1,"form-options"],[1,"checkbox-label"],["type","checkbox","formControlName","rememberMe"],["routerLink","/auth/forgot-password",1,"link"],["type","submit",1,"btn-primary",3,"disabled"],[1,"auth-footer"],["routerLink","/auth/register",1,"link"],[1,"error-text"]],template:function(s,a){s&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),i(4,"Welcome Back"),o(),n(5,"p"),i(6,"Sign in to your TalentForge account"),o()(),p(7,J,16,1,"div",3)(8,Y,6,2,"div",4)(9,H,2,1,"div",5)(10,ot,29,12,"form",6),o()()),s&2&&(r(7),l("ngIf",a.isLocked),r(),l("ngIf",a.showAttemptsWarning&&!a.isLocked),r(),l("ngIf",a.errorMessage),r(),l("ngIf",!a.isLocked))},dependencies:[y,L,G,V,D,F,z,N,R,j,I,T],styles:['.auth-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#06f,#00d4ff);padding:2rem;position:relative;overflow:hidden}.auth-container[_ngcontent-%COMP%]:before{content:"";position:absolute;top:-50%;right:-50%;width:100%;height:100%;background:radial-gradient(circle,rgba(255,255,255,.1) 0%,transparent 70%)}.auth-container[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:-50%;left:-50%;width:100%;height:100%;background:radial-gradient(circle,rgba(255,255,255,.05) 0%,transparent 70%)}.auth-card[_ngcontent-%COMP%]{background:#fffffff2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:16px;box-shadow:0 20px 60px #0000004d;padding:3rem;max-width:450px;width:100%;position:relative;z-index:1;border:1px solid rgba(255,255,255,.2)}.auth-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:2.5rem}.auth-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;color:#1e293b;margin:0 0 .75rem;background:linear-gradient(135deg,#06f,#00d4ff);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.auth-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#64748b;font-size:.9375rem;margin:0}.form-group[_ngcontent-%COMP%]{margin-bottom:1.5rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:.875rem;font-weight:500;color:#475569;margin-bottom:.5rem}.form-control[_ngcontent-%COMP%]{width:100%;padding:12px 16px;border:1px solid #e2e8f0;border-radius:8px;font-size:.875rem;transition:all .2s;box-sizing:border-box}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#06f;box-shadow:0 0 0 3px #0066ff26}.form-control.error[_ngcontent-%COMP%]{border-color:#ef4444}.password-wrapper[_ngcontent-%COMP%]{position:relative}.password-wrapper[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{padding-right:45px}.toggle-password[_ngcontent-%COMP%]{position:absolute;right:12px;top:50%;transform:translateY(-50%);background:none;border:none;cursor:pointer;font-size:1.25rem;padding:0;line-height:1}.error-text[_ngcontent-%COMP%]{color:#ef4444;font-size:.75rem;margin-top:.5rem}.form-options[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-size:.875rem;color:#475569;cursor:pointer}.btn-primary[_ngcontent-%COMP%]{width:100%;padding:14px;border:none;border-radius:8px;font-weight:600;cursor:pointer;transition:all .3s;background:linear-gradient(135deg,#06f,#00d4ff);color:#fff;margin-bottom:1rem;font-size:.9375rem;box-shadow:0 4px 15px #06f6}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 6px 20px #06f9}.btn-primary[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed;transform:none}.auth-footer[_ngcontent-%COMP%]{text-align:center;font-size:.875rem;color:#64748b}.link[_ngcontent-%COMP%]{color:#06f;text-decoration:none;font-size:.875rem;font-weight:500;transition:all .2s}.link[_ngcontent-%COMP%]:hover{color:#0052cc;text-decoration:underline}.error-message[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b;padding:12px;border-radius:8px;margin-bottom:1.5rem;font-size:.875rem}.lockout-warning[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fee2e2,#fecaca);border:2px solid #ef4444;border-radius:12px;padding:24px;text-align:center;margin-bottom:1.5rem}.lockout-icon[_ngcontent-%COMP%]{font-size:3rem;margin-bottom:12px}.lockout-warning[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#991b1b;font-size:1.25rem;font-weight:600;margin:0 0 8px}.lockout-warning[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#7f1d1d;margin:0 0 16px;font-size:.875rem}.countdown[_ngcontent-%COMP%]{background:#fff;border-radius:8px;padding:16px;margin-bottom:16px}.countdown[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{display:block;font-size:2rem;font-weight:700;color:#dc2626;font-family:monospace}.countdown[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{display:block;font-size:.75rem;color:#7f1d1d;text-transform:uppercase;letter-spacing:1px;margin-top:4px}.lockout-warning[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]{font-size:.8125rem;color:#7f1d1d}.lockout-warning[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#dc2626;font-weight:600;text-decoration:none}.lockout-warning[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.attempts-warning[_ngcontent-%COMP%]{background:#fef3c7;border-left:4px solid #f59e0b;padding:12px 16px;border-radius:8px;margin-bottom:1.5rem;display:flex;align-items:flex-start;gap:12px;font-size:.875rem;color:#92400e;line-height:1.5}.warning-icon[_ngcontent-%COMP%]{font-size:1.25rem;flex-shrink:0}.final-warning[_ngcontent-%COMP%]{font-weight:600;color:#dc2626}@media (max-width: 768px){.auth-container[_ngcontent-%COMP%]{padding:1rem}.auth-card[_ngcontent-%COMP%]{padding:2rem 1.5rem}.auth-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.5rem}.lockout-icon[_ngcontent-%COMP%]{font-size:2.5rem}.countdown[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{font-size:1.5rem}}']})}}return e})();export{ft as LoginStandaloneComponent};
